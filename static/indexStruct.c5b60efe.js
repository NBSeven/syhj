import{g as a,c as e,d as t,s}from"./service.740034dd.js";import{g as r}from"./getQuery.cd413be6.js";import{_ as o}from"./lodash.199d46d6.js";import{_ as l,a as d,k as u,m as i,N as c,S as m,W as p,b as n,e as b,w as y,r as f,o as h,F as w,n as L,f as I,i as _,I as g,y as S,E as v,X as D,z as x,A as R}from"./index.5e590414.js";const Y={class:"bom-loss"},F=(a=>(x("data-v-1af0eb92"),a=a(),R(),a))((()=>_("div",{class:"card-header"},[_("span",null,"结构料bom损耗率表单")],-1))),N=S("%"),j={style:{float:"right",margin:"20px 0"}},E=S("提交");var V=l(d({__name:"indexStruct",setup(l,{expose:d}){const S=u({bomLossStructData:[],years:[]});let x=1,R=1;const V=async()=>{let a=[];a=o.cloneDeep(S.bomLossStructData);let e=a.map((a=>({...a,lossRateYearList:a.lossRateYearList.map((a=>({year:a.year,rate:(Number(a.rate)/100).toFixed(4)})))})));(await s(e)).success&&v({type:"success",message:"提交成功"})};return i((()=>{})),c((async()=>{let s=r();x=s.auditFlowId?Number(s.auditFlowId):1,R=s.productId?Number(s.productId):1;let o=s.right,{result:l}=await a(x);if(S.years=l,"1"===o){let a=await e({auditFlowId:x,productId:R});S.bomLossStructData=a.result,S.bomLossStructData.forEach((a=>{a.lossRateYearList.forEach((a=>{a.rate=100*Number(a.rate)}))}))}else{let a=await t({auditFlowId:x,productId:R});S.bomLossStructData=a.result,S.bomLossStructData.forEach((a=>{a.lossRateYearList=[],a.lossRateYearList=S.years.map((a=>({year:a,rate:""})))}))}})),m((()=>{})),d({...p(S)}),(a,e)=>{const t=f("el-table-column"),s=f("el-input"),r=f("el-table"),o=f("el-button"),l=f("el-card"),d=D("havedone");return h(),n("div",Y,[b(l,{class:"card"},{header:y((()=>[F])),default:y((()=>[b(r,{data:S.bomLossStructData,border:"",style:{width:"100%"},height:"500"},{default:y((()=>[b(t,{type:"index",width:"50"}),b(t,{prop:"superType",label:"种类",width:"180"}),b(t,{prop:"categoryName",label:"物料大类",width:"180"}),(h(!0),n(w,null,L(S.years,((a,e)=>(h(),I(t,{label:a+"",key:a},{default:y((({row:a})=>[b(s,{modelValue:a.lossRateYearList[e].rate,"onUpdate:modelValue":t=>a.lossRateYearList[e].rate=t,type:"number"},{append:y((()=>[N])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["label"])))),128))])),_:1},8,["data"]),_("div",j,[g((h(),I(o,{type:"primary",onClick:V},{default:y((()=>[E])),_:1})),[[d]])])])),_:1})])}}}),[["__scopeId","data-v-1af0eb92"]]);export{V as default};
