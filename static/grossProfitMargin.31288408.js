import{c as e,e as a,f as l}from"./service.a48ac066.js";import{_ as i,a as s,k as o,m as r,N as t,S as n,W as d,b as u,i as g,e as m,w as c,r as p,o as f,F as b,n as _,t as M,f as v,g as V,y as F,Z as k,E as y}from"./index.02b7f6cd.js";import{p as N,m as C}from"./plus.5180ea83.js";import"./plugin-vue_export-helper.c1230001.js";const P={class:"grossProfitMargin"},x={class:"grossProfitMargin__btn-container"},D=F("搜索"),h={class:"grossProfitMargin__btn-container"},w=F("新增毛利率方案"),U=F(),z={key:0},j={key:1},E=F("编辑"),S=F("删除"),R={class:"grossProfitMargin__btn-container"},B=F("%"),T={class:"dialog-footer"},$=F("取消"),I=F("保存");var W=i(s({__name:"grossProfitMargin",setup(i,{expose:s}){const F=o({searchForm:{grossMarginName:"",maxResultCount:20,skipCount:0},isEdit:!1,editForm:{grossMarginName:"",isDefaultn:!1,grossMarginPrice:[{value:""}]},dialogVisible:!1,tableData:[],pageNo:1,pageSize:20,total:0}),W=()=>{F.editForm.grossMarginPrice.push({value:""})},Z=async()=>{let a={grossMarginName:"",maxResultCount:20,skipCount:0};a.grossMarginName=F.searchForm.grossMarginName,a.skipCount=(F.pageNo-1)*F.pageSize,a.maxResultCount=F.pageSize;let l=await e(a);F.tableData=l.result.items,F.total=l.result.totalCount},q=()=>{},A=()=>{Z()},G=()=>{F.isEdit=!1,F.editForm={grossMarginName:"",grossMarginPrice:[{value:""}],isDefaultn:!1}},H=async()=>{let e=null,{editForm:a}=F,i={};a.id&&(i.id=a.id),i.isDefaultn=a.isDefaultn,i.grossMarginName=a.grossMarginName,i.grossMarginPrice=a.grossMarginPrice.map((e=>e.value)),e=await l(i),e.success&&(y({type:"success",message:"保存成功"}),F.dialogVisible=!1,Z())};return r((()=>{})),t((()=>{A()})),n((()=>{})),s({...d(F)}),(e,l)=>{const i=p("el-input"),s=p("el-form-item"),o=p("el-button"),r=p("el-form"),t=p("el-table-column"),n=p("el-table"),d=p("el-pagination"),Z=p("el-switch"),J=p("el-button-group"),K=p("el-dialog");return f(),u("div",null,[g("div",P,[g("div",x,[m(r,{model:F.searchForm,inline:""},{default:c((()=>[m(s,{label:"毛利率方案"},{default:c((()=>[m(i,{modelValue:F.searchForm.grossMarginName,"onUpdate:modelValue":l[0]||(l[0]=e=>F.searchForm.grossMarginName=e)},null,8,["modelValue"])])),_:1}),m(s,null,{default:c((()=>[m(o,{type:"primary",onClick:A},{default:c((()=>[D])),_:1})])),_:1})])),_:1},8,["model"])]),g("div",h,[m(o,{type:"primary",onClick:l[1]||(l[1]=e=>F.dialogVisible=!0)},{default:c((()=>[w])),_:1})]),m(n,{data:F.tableData},{default:c((()=>[m(t,{label:"毛利率方案",prop:"grossMarginName"}),m(t,{label:"毛利率"},{default:c((e=>[(f(!0),u(b,null,_(e.row.grossMarginPrice,((e,a)=>(f(),u("div",{key:a},[g("span",null,"序号"+M(a+1)+":",1),U,g("span",null,M(e)+" %",1)])))),128))])),_:1}),m(t,{label:"是否默认"},{default:c((e=>[g("div",null,[e.row.isDefaultn?(f(),u("div",z,"是")):(f(),u("div",j,"否"))])])),_:1}),m(t,{label:"操作"},{default:c((e=>[m(o,{size:"small",onClick:a=>{return e.$index,l=e.row,F.isEdit=!0,F.editForm.isDefaultn=l.isDefaultn,F.editForm.id=l.id,F.editForm.grossMarginName=l.grossMarginName,F.editForm.grossMarginPrice=l.grossMarginPrice.map((e=>({value:e}))),void(F.dialogVisible=!0);var l}},{default:c((()=>[E])),_:2},1032,["onClick"]),m(o,{size:"small",type:"danger",onClick:l=>{return e.$index,i=e.row,void k.confirm("确定删除该毛利率?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{"200"===(await a(i.id)).code&&y({type:"success",message:"删除成功"})}));var i}},{default:c((()=>[S])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),g("div",R,[m(d,{background:"",layout:"prev, pager, next",total:F.total,"page-size":20,currentPage:F.pageNo,"onUpdate:currentPage":[l[2]||(l[2]=e=>F.pageNo=e),q]},null,8,["total","currentPage"])]),m(K,{modelValue:F.dialogVisible,"onUpdate:modelValue":l[6]||(l[6]=e=>F.dialogVisible=e),title:"毛利率方案",onClose:G},{footer:c((()=>[g("span",T,[m(o,{onClick:l[5]||(l[5]=e=>F.dialogVisible=!1)},{default:c((()=>[$])),_:1}),m(o,{type:"primary",onClick:H},{default:c((()=>[I])),_:1})])])),default:c((()=>[m(r,{model:F.editForm},{default:c((()=>[m(s,{label:"毛利率方案名称"},{default:c((()=>[m(i,{modelValue:F.editForm.grossMarginName,"onUpdate:modelValue":l[3]||(l[3]=e=>F.editForm.grossMarginName=e)},null,8,["modelValue"])])),_:1}),m(s,{label:"是否默认"},{default:c((()=>[m(Z,{modelValue:F.editForm.isDefaultn,"onUpdate:modelValue":l[4]||(l[4]=e=>F.editForm.isDefaultn=e)},null,8,["modelValue"])])),_:1}),m(s,{label:"毛利率值"},{default:c((()=>[(f(!0),u(b,null,_(F.editForm.grossMarginPrice,((e,a)=>(f(),v(i,{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,placeholder:"请输入毛利率",style:{"margin-bottom":"20px"},key:a},{append:c((()=>[m(J,null,{default:c((()=>[m(o,{disabled:""},{default:c((()=>[B])),_:1}),m(o,{icon:V(N),onClick:W},null,8,["icon"]),m(o,{icon:V(C),onClick:e=>(e=>{F.editForm.grossMarginPrice.splice(e,1)})(a),disabled:1===F.editForm.grossMarginPrice.length},null,8,["icon","onClick","disabled"])])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])))),128))])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])])}}}),[["__scopeId","data-v-7206a9bc"]]);export{W as default};
