import{g as a}from"./dictionary.374959de.js";import{g as e,s as t}from"./service.99cb2e85.js";import{_ as s,a as r,k as l,m as i,N as o,S as y,W as u,b as d,e as p,w as c,r as n,o as m,y as b,t as g,F as f,n as h,f as w,i as _,E as C}from"./index.ad8f3002.js";const F=b("%"),q={style:{float:"right",margin:"20px 0"}},D=b("提交");var L=s(r({__name:"qualityCost",setup(s,{expose:r}){const L=l({tableData:[],years:[],productTypeMap:{}}),N=a=>{let e=(new Date).getFullYear(),t=[e];for(let s=1;s<a;s++)t.push(e+s);return t},Y=async()=>{let a=L.tableData.map((a=>{let{category:e,isFirst:t,qualityCostYearList:s}=a;return{category:e,isFirst:t,qualityCostYearList:s.map((a=>({year:a.year,rate:(Number(a.rate)/100).toFixed(4)})))}}));(await t(a)).success&&C({type:"success",message:"保存成功"})};return i((async()=>{(await a("ProductType")).result.financeDictionaryDetailList.forEach((a=>{L.productTypeMap[a.id]=a.displayName,L.tableData.push({categoryName:a.displayName,category:a.id,isFirst:!0,qualityCostYearList:[]}),L.tableData.push({categoryName:a.displayName,category:a.id,isFirst:!1,qualityCostYearList:[]})}));let t=await e();t.result.length>0?(L.years=N(10),L.tableData=t.result.map((a=>{let{category:e,isFirst:t,qualityCostYearList:s}=a;return{category:e,categoryName:L.productTypeMap[e],isFirst:t,qualityCostYearList:s.map((a=>({year:a.year,rate:(100*Number(a.rate)).toFixed(2)})))}}))):(L.years=N(10),L.tableData.forEach((a=>{a.qualityCostYearList=L.years.map((a=>({year:a,rate:0})))})))})),o((async()=>{})),y((()=>{})),r({...u(L)}),(a,e)=>{const t=n("el-table-column"),s=n("el-input"),r=n("el-table"),l=n("el-button"),i=n("el-card");return m(),d("div",null,[p(i,{class:"card"},{default:c((()=>[p(r,{data:L.tableData,style:{width:"100%","margin-top":"25px"},border:""},{default:c((()=>[p(t,{type:"index",width:"80"}),p(t,{label:"类别",prop:"categoryName",width:"180"}),p(t,{label:"是否首款产品",width:"180"},{default:c((({row:a})=>[b(g(a.isFirst?"是":"否"),1)])),_:1}),p(t,{label:"质量成本比例"},{default:c((()=>[(m(!0),d(f,null,h(L.years,((a,e)=>(m(),w(t,{label:a+"",key:a,width:"200"},{default:c((({row:a})=>[p(s,{modelValue:a.qualityCostYearList[e].rate,"onUpdate:modelValue":t=>a.qualityCostYearList[e].rate=t,type:"number"},{append:c((()=>[F])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["label"])))),128))])),_:1})])),_:1},8,["data"]),_("div",q,[p(l,{type:"primary",onClick:Y},{default:c((()=>[D])),_:1})])])),_:1})])}}}),[["__scopeId","data-v-1e309ea3"]]);export{L as default};
