import{P as e,G as a}from"./request.578b9ba3.js";import{g as t}from"./dictionary.0e21c543.js";import{g as l}from"./getQuery.b59b1282.js";import{_ as o,a as d,k as r,m as u,N as n,S as s,b as i,e as m,w as c,i as p,I as h,f as y,E as f,r as V,o as b,g as w,y as _,t as N,F as g,n as C,X as v}from"./index.c6c04119.js";const U=e=>{const{columns:a,data:t}=e,l=[];return a.forEach(((e,a)=>{if(4===a)return void(l[a]="手板件总费用");const o=t.map((e=>Number((e.quantity||0)*(e.unitPrice||0))));o.every((e=>Number.isNaN(e)))||5!==a?l[a]="":l[a]=`¥ ${o.reduce(((e,a)=>Number.isNaN(a)?e:e+a),0)}`})),l},k=e=>{const{columns:a,data:t}=e,l=[];return a.forEach(((e,a)=>{if(1===a)return void(l[a]="其他费用合计");const o=t.map((e=>Number(e.cost)));o.every((e=>Number.isNaN(e)))||2!==a?l[a]="":l[a]=`¥ ${o.reduce(((e,a)=>Number.isNaN(a)?e:e+a),0)}`})),l},x=e=>{const{columns:a,data:t}=e,l=[];return a.forEach(((e,a)=>{if(2===a)return void(l[a]="费用合计/天");if(4===a)return void(l[a]="费用合计");const o=t.map((e=>Number(e.costSky)));o.every((e=>Number.isNaN(e)))||3!==a||(l[a]=`¥ ${o.reduce(((e,a)=>Number.isNaN(a)?e:e+a),0)}`);const d=t.map((e=>Number(e.cost)));d.every((e=>Number.isNaN(e)))||5!==a||(l[a]=`¥ ${d.reduce(((e,a)=>Number.isNaN(a)?e:e+a),0)}`)})),l};const P={style:{padding:"0 10px"}},j=_(" 手板件费用 "),E=_("新增"),I=_("删除"),q=_(" 其它费用 "),$=_("新增"),S=_("删除"),R=_(" 差旅费 "),F=_("新增"),M=_("删除"),O={style:{float:"right",margin:"20px 0"}},D=_("提交");var G=o(d({__name:"nreProjectManageMent",setup(o){const{auditFlowId:d=1,productId:G=1}=l(),L=r({handPieceCost:[],restsCost:[],travelExpense:[],nreResonOptions:[]}),Q=()=>{L.handPieceCost.push({partName:"",partNumber:"",unitPrice:0,quantity:0})},X=()=>{L.restsCost.push({rroject:"",cost:0,remark:""})},z=()=>{L.travelExpense.push({reasonsId:"",peopleCount:0,costSky:0,skyCount:0,cost:0,remark:""})},A=async()=>{try{const{success:a}=await e({projectManagement:{...L,handPieceCost:L.handPieceCost.map((e=>({...e,cost:(e.unitPrice||0)*(e.quantity||0)}))),productId:G},auditFlowId:d});a&&f.success("提交成功！")}catch(a){}};return u((async()=>{let e=await t("NreReasons");L.nreResonOptions=e.result.financeDictionaryDetailList})),n((()=>{(async()=>{const{result:e}=await a(d,G);if(!e)return!1;L.handPieceCost=null==e?void 0:e.handPieceCost,L.restsCost=null==e?void 0:e.restsCost,L.travelExpense=null==e?void 0:e.travelExpense})()})),s((()=>{})),(e,a)=>{const t=V("el-button"),l=V("el-row"),o=V("el-table-column"),d=V("el-input"),r=V("el-input-number"),u=V("el-table"),n=V("el-card"),s=V("el-option"),f=V("el-select"),G=v("havedone");return b(),i("div",P,[m(n,{class:"margin-top"},{header:c((()=>[m(l,{style:{width:"100%"},justify:"space-between",align:"middle"},{default:c((()=>[j,h((b(),y(t,{type:"primary",onClick:Q},{default:c((()=>[E])),_:1})),[[G]])])),_:1})])),default:c((()=>[m(u,{data:L.handPieceCost,"summary-method":w(U),"show-summary":"",style:{width:"100%"},border:"",height:"300"},{default:c((()=>[m(o,{type:"index",width:"50"}),m(o,{label:"零件名",width:"150"},{default:c((({row:e})=>[m(d,{modelValue:e.partName,"onUpdate:modelValue":a=>e.partName=a},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),m(o,{label:"料号",width:"150"},{default:c((({row:e})=>[m(d,{modelValue:e.partNumber,"onUpdate:modelValue":a=>e.partNumber=a},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),m(o,{label:"单价",width:"100"},{default:c((({row:e})=>[m(r,{modelValue:e.unitPrice,"onUpdate:modelValue":a=>e.unitPrice=a,min:0,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),m(o,{label:"数量",width:"150"},{default:c((({row:e})=>[m(r,{modelValue:e.quantity,"onUpdate:modelValue":a=>e.quantity=a,min:0,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),m(o,{label:"费用",prop:"cost",width:"100"},{default:c((({row:e})=>[_(N(e.unitPrice*e.quantity),1)])),_:1}),m(o,{label:"备注"},{default:c((({row:e})=>[m(d,{modelValue:e.remark,"onUpdate:modelValue":a=>e.remark=a},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),m(o,{label:"操作",fixed:"right",width:"90"},{default:c((({$index:e})=>[h((b(),y(t,{onClick:a=>{return t=e,void L.handPieceCost.splice(t,1);var t},type:"danger"},{default:c((()=>[I])),_:2},1032,["onClick"])),[[G]])])),_:1})])),_:1},8,["data","summary-method"])])),_:1}),m(n,{class:"margin-top"},{header:c((()=>[m(l,{style:{width:"100%"},justify:"space-between",align:"middle"},{default:c((()=>[q,h((b(),y(t,{type:"primary",onClick:X},{default:c((()=>[$])),_:1})),[[G]])])),_:1})])),default:c((()=>[m(u,{data:L.restsCost,style:{width:"100%"},border:"","summary-method":w(k),"show-summary":"",height:"300"},{default:c((()=>[m(o,{type:"index",width:"50"}),m(o,{label:"费用名称"},{default:c((({row:e})=>[m(d,{modelValue:e.rroject,"onUpdate:modelValue":a=>e.rroject=a},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),m(o,{label:"费用"},{default:c((({row:e})=>[m(d,{modelValue:e.cost,"onUpdate:modelValue":a=>e.cost=a,min:0,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),m(o,{label:"备注"},{default:c((({row:e})=>[m(d,{modelValue:e.remark,"onUpdate:modelValue":a=>e.remark=a},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),m(o,{label:"操作",fixed:"right",width:"90"},{default:c((({$index:e})=>[h((b(),y(t,{onClick:a=>{return t=e,void L.restsCost.splice(t,1);var t},type:"danger"},{default:c((()=>[S])),_:2},1032,["onClick"])),[[G]])])),_:1})])),_:1},8,["data","summary-method"])])),_:1}),m(n,{class:"margin-top"},{header:c((()=>[m(l,{style:{width:"100%"},justify:"space-between",align:"middle"},{default:c((()=>[R,h((b(),y(t,{type:"primary",onClick:z},{default:c((()=>[F])),_:1})),[[G]])])),_:1})])),default:c((()=>[m(u,{data:L.travelExpense,style:{width:"100%"},border:"",height:"300","show-summary":"","summary-method":w(x)},{default:c((()=>[m(o,{type:"index",width:"50"}),m(o,{label:"事由",width:"150"},{default:c((({row:e})=>[m(f,{modelValue:e.reasonsId,"onUpdate:modelValue":a=>e.reasonsId=a},{default:c((()=>[(b(!0),i(g,null,C(L.nreResonOptions,(e=>(b(),y(s,{key:e.id,label:e.displayName,value:e.id},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),m(o,{label:"人数",width:"150"},{default:c((({row:e})=>[m(d,{modelValue:e.peopleCount,"onUpdate:modelValue":a=>e.peopleCount=a,min:0,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),m(o,{label:"费用/天",width:"150"},{default:c((({row:e})=>[m(d,{modelValue:e.costSky,"onUpdate:modelValue":a=>e.costSky=a,min:0,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),m(o,{label:"天数",width:"150"},{default:c((({row:e})=>[m(d,{modelValue:e.skyCount,"onUpdate:modelValue":a=>e.skyCount=a,min:0,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),m(o,{label:"费用",width:"150"},{default:c((({row:e})=>[m(d,{modelValue:e.cost,"onUpdate:modelValue":a=>e.cost=a,min:0,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),m(o,{label:"备注"},{default:c((({row:e})=>[m(d,{modelValue:e.remark,"onUpdate:modelValue":a=>e.remark=a},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),m(o,{label:"操作",fixed:"right",width:"90"},{default:c((({$index:e})=>[h((b(),y(t,{onClick:a=>{return t=e,void L.handPieceCost.splice(t,1);var t},type:"danger"},{default:c((()=>[M])),_:2},1032,["onClick"])),[[G]])])),_:1})])),_:1},8,["data","summary-method"])])),_:1}),p("div",O,[h((b(),y(t,{type:"primary",onClick:A},{default:c((()=>[D])),_:1})),[[G]])])])}}}),[["__scopeId","data-v-1293439c"]]);export{G as default};
