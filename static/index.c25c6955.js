import{G as a,P as e}from"./service.a0deb8d5.js";import{g as t}from"./getQuery.b88fabca.js";import{g as o}from"./service.5433b151.js";import{u as l}from"./useJump.3b2f0217.js";import{_ as r,a as n,k as s,m as i,N as d,S as p,f as m,w as u,r as c,o as g,b,e as f,x as _,y,t as k,n as h,F as w,I as D,Z as x,X as Q}from"./index.233133c1.js";const N={key:0,style:{margin:"20px 0",float:"right"}},C=y("点击查看报价分析看板"),M=y("点击查看物流可返利金额"),v=y("同意"),S=y("拒绝");var j=r(n({__name:"index",setup(r){const{jumpTodoCenter:n,jumpPage:j}=l(),{auditFlowId:I=1}=t(),B=s({projectName:"",developmentPlan:"",marketingQuotationData:{motionMessage:[]},motionMessageSop:[],isShowBtn:!1}),F=s({sopData:[]});i((()=>{"总经理"===JSON.parse(window.localStorage.getItem("user")||"").userJobs&&(B.isShowBtn=!0)})),d((()=>{T(),R()}));const P=()=>{j("/quoteAnalysis/index",{auditFlowId:I})},J=()=>{j("/pmDepartment/index",{auditFlowId:I})},T=async()=>{const{result:e}=await a({Id:I});B.marketingQuotationData=e,B.motionMessageSop=e.motionMessage[0].sop.map((a=>a))},R=async()=>{const{result:a}=await o(I)||{};F.sopData=a||[]},q=a=>{let t=a?"您确定要同意嘛？":"请输入拒绝理由";x[a?"confirm":"prompt"](t,"报价审核",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async t=>{const{success:o}=await e({...B.marketingQuotationData,isPass:a,auditFlowId:I,opinionDescription:a?"":null==t?void 0:t.value});o&&n()}))};return p((()=>{})),(a,e)=>{const t=c("el-button"),o=c("el-descriptions-item"),l=c("el-descriptions"),r=c("el-table-column"),n=c("el-table"),s=c("el-card"),i=c("el-row"),d=Q("havedone");return g(),m(s,{class:"marketingQuotation-page",header:"报价审核",m:"2"},{default:u((()=>[B.isShowBtn?(g(),b("div",N,[f(t,{type:"primary",onClick:P},{default:u((()=>[C])),_:1}),f(t,{type:"primary",onClick:J},{default:u((()=>[M])),_:1})])):_("",!0),f(l,{column:2,border:""},{default:u((()=>[f(o,{label:"直接客户名称"},{default:u((()=>[y(k(B.marketingQuotationData.directCustomerName),1)])),_:1}),f(o,{label:"客户性质"},{default:u((()=>[y(k(B.marketingQuotationData.clientNature),1)])),_:1}),f(o,{label:"终端客户名称"},{default:u((()=>[y(k(B.marketingQuotationData.terminalCustomerName),1)])),_:1}),f(o,{label:"终端客户性质"},{default:u((()=>[y(k(B.marketingQuotationData.terminalClientNature),1)])),_:1}),f(o,{label:"开发计划"},{default:u((()=>[y(k(B.marketingQuotationData.developmentPlan),1)])),_:1}),f(o,{label:"汇率"},{default:u((()=>[y(k(B.marketingQuotationData.exchangeRate),1)])),_:1})])),_:1}),f(s,{header:"sop5年内走量信息",m:"2"},{default:u((()=>{var a;return[f(n,{data:null==(a=B.marketingQuotationData)?void 0:a.motionMessage,border:""},{default:u((()=>[f(r,{type:"index",width:"100"}),f(r,{label:"名称",prop:"messageName"}),(g(!0),b(w,null,h(null==B?void 0:B.motionMessageSop,((a,e)=>(g(),m(r,{key:a.year,label:a.year,prop:`sop[${e}].value`},null,8,["label","prop"])))),128))])),_:1},8,["data"])]})),_:1}),f(s,{header:"核心部件：",m:"2"},{default:u((()=>[(g(!0),b(w,null,h(B.marketingQuotationData.coreComponent,(a=>(g(),m(s,{key:a.messageName,header:a.componentName,class:"m-2"},{default:u((()=>[f(n,{data:a.productSubclass,border:""},{default:u((()=>[f(r,{label:"核心部件",prop:"coreComponent"}),f(r,{label:"型号",prop:"model"}),f(r,{label:"类型",prop:"type"}),f(r,{label:"备注",prop:"remark"})])),_:2},1032,["data"])])),_:2},1032,["header"])))),128))])),_:1}),f(s,{header:"NRE费用：",m:"2"},{default:u((()=>[(g(!0),b(w,null,h(B.marketingQuotationData.nreCost,(a=>(g(),m(s,{key:a.messageName,header:a.nreCostModuleName,class:"m-2"},{default:u((()=>[f(n,{data:a.nreCostModels,border:""},{default:u((()=>[f(r,{type:"index",width:"100"}),f(r,{label:"费用类别",prop:"name"}),f(r,{label:"成本",prop:"cost"})])),_:2},1032,["data"])])),_:2},1032,["header"])))),128))])),_:1}),f(s,{header:"内部核价信息：",m:"2"},{default:u((()=>[(g(!0),b(w,null,h(B.marketingQuotationData.pricingMessage,(a=>(g(),m(s,{key:a.messageName,header:a.pricingMessageName,class:"m-2"},{default:u((()=>[f(n,{data:a.pricingMessageModels,border:""},{default:u((()=>[f(r,{label:"序号",type:"index",width:"100"}),f(r,{label:"费用类别",prop:"name"}),f(r,{label:"成本值",prop:"costValue"})])),_:2},1032,["data"])])),_:2},1032,["header"])))),128))])),_:1}),f(s,{header:"报价策略：",m:"2"},{default:u((()=>[f(n,{data:B.marketingQuotationData.biddingStrategy,border:""},{default:u((()=>[f(r,{type:"index",width:"100"}),f(r,{label:"产品",prop:"product"}),f(r,{label:"成本",prop:"cost"}),f(r,{label:"毛利率",prop:"grossMargin"}),f(r,{label:"价格",prop:"price"}),f(r,{label:"佣金",prop:"commission"}),f(r,{label:"含佣金的毛利率",prop:"grossMarginCommission"})])),_:1},8,["data"])])),_:1}),f(s,{header:"费用表：",m:"2"},{default:u((()=>[f(n,{data:B.marketingQuotationData.expensesStatement,border:""},{default:u((()=>[f(r,{type:"index",width:"100"}),f(r,{label:"费用类别",prop:"formName"}),f(r,{label:"核价金额",prop:"pricingMoney"}),f(r,{label:"报价系数",prop:"offerCoefficient"}),f(r,{label:"备注",prop:"remark"})])),_:1},8,["data"])])),_:1}),f(i,{justify:"end",style:{"margin-top":"20px"}},{default:u((()=>[D((g(),m(t,{type:"primary",onClick:e[0]||(e[0]=a=>q(!0))},{default:u((()=>[v])),_:1})),[[d]]),D((g(),m(t,{type:"danger",onClick:e[1]||(e[1]=a=>q(!1))},{default:u((()=>[S])),_:1})),[[d]])])),_:1})])),_:1})}}}),[["__scopeId","data-v-cae524de"]]);export{j as default};
