import{d as e,e as a,f as o}from"./request.9bb9f23d.js";import{g as t}from"./mouldSummaries.62f35173.js";import{g as l}from"./getQuery.bab2d130.js";import{_ as s,a as r,k as u,m as d,N as n,S as m,f as i,w as c,r as p,o as y,e as f,g as b,b as h,t as w,y as V,i as g,I as v,E as _,X as I}from"./index.9c83b174.js";const D={key:1},M={style:{float:"right",margin:"20px 0"}},U=V("计算"),C=V("提交");var N=s(r({__name:"nreResourcesDepartment",setup(s){const{auditFlowId:r,productId:N}=l(),k=u({resourceData:[],resourcesManagementModels:[]}),j=async()=>{const{success:e}=await a({auditFlowId:r,resourcesManagementModels:{mouldInventory:k.resourceData.map((e=>({...e,cost:(e.unitPrice||0)*(e.count||0)}))),productId:N}});e&&_.success("提交成功！")},x=async()=>{try{const{result:e,success:a}=await o({mouldInventory:k.resourceData,productId:N});a||_.success("计算成功");const{mouldInventory:t=[]}=e||[];k.resourceData=t.map(((e,a)=>"吸塑/包材"===e.modelName?k.resourceData[a]:e))}catch(e){_.error("计算失败")}};return d((()=>{})),n((()=>{(async()=>{const{result:a}=await e(r,N);k.resourceData=(null==a?void 0:a.mouldInventoryModels)||[],k.resourcesManagementModels=null==a?void 0:a.mouldInventoryModels})()})),m((()=>{})),(e,a)=>{const o=p("el-table-column"),l=p("el-input-number"),s=p("el-table"),r=p("el-button"),u=p("el-card"),d=I("havedone");return y(),i(u,null,{default:c((()=>[f(u,{class:"margin-top"},{default:c((()=>[f(s,{data:k.resourceData,border:"","summary-method":b(t),"show-summary":"",height:"72vh"},{default:c((()=>[f(o,{type:"index",width:"50"}),f(o,{label:"模具名称",prop:"modelName",width:"180"}),f(o,{label:"模穴数",width:"180"},{default:c((({row:e})=>[f(l,{modelValue:e.moldCavityCount,"onUpdate:modelValue":a=>e.moldCavityCount=a,min:0,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),f(o,{label:"模次数",width:"180"},{default:c((({row:e})=>[f(l,{modelValue:e.modelNumber,"onUpdate:modelValue":a=>e.modelNumber=a,min:0,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),f(o,{label:"数量",prop:"count",width:"180"},{default:c((({row:e})=>["吸塑/包材"===e.modelName?(y(),i(l,{key:0,modelValue:e.count,"onUpdate:modelValue":a=>e.count=a,"controls-position":"right",min:0},null,8,["modelValue","onUpdate:modelValue"])):(y(),h("div",D,w(e.count),1))])),_:1}),f(o,{label:"单价",width:"180"},{default:c((({row:e})=>[f(l,{modelValue:e.unitPrice,"onUpdate:modelValue":a=>e.unitPrice=a,min:0,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),f(o,{label:"费用"},{default:c((({row:e})=>[V(w(e.unitPrice*e.count),1)])),_:1})])),_:1},8,["data","summary-method"]),g("div",M,[v((y(),i(r,{type:"primary",onClick:x},{default:c((()=>[U])),_:1})),[[d]]),v((y(),i(r,{type:"primary",onClick:j},{default:c((()=>[C])),_:1})),[[d]])])])),_:1})])),_:1})}}}),[["__scopeId","data-v-6c8dff62"]]);export{N as default};
