import{g as a,a as e,b as d,u as t,d as l}from"./departmentManage.7d26dc8f.js";import{_ as s,a as i,k as o,m as n,N as m,S as r,W as c,b as u,i as f,e as p,w as g,g as y,r as F,o as b,t as _,f as V,x as k,y as x,E as h,Z as C}from"./index.5e590414.js";const E={class:"departmentManage"},w={class:"departmentManage__btn-container"},v=x("创建部门"),D={class:"custom-tree-node"},M=x(" 修改 "),U=x(" 删除 "),j={class:"dialog-footer"},B=x("取消"),N=x("保存");var T=s(i({__name:"index",setup(s,{expose:i}){let x=o({name:""});const T=a=>{x.name=a.name,W.addForm.fid=a.fid,W.addForm.id=a.id},z=()=>{x.name="",W.addForm.fid=0,W.addForm.id=0,W.addForm.name="",W.isEdit=!1},I=(e,d)=>{if(0===e.level)return d([]);a(e.data.id).then((a=>{d(a.result.items)})).catch((()=>{d([])}))},S={children:"children",label:"name"};let W=o({treeData:[],dialogVisible:!1,addForm:{name:""},isEdit:!1}),Z=async()=>{let a=null;if(W.addForm.id&&!W.isEdit){let e={};e.fid=W.addForm.id,e.name=W.addForm.name,a=await d(e)}else a=W.isEdit?await t(W.addForm):await d({name:W.addForm.name});a.success&&(W.isEdit=!1,W.dialogVisible=!1,h({type:"success",message:"保存成功"}),q())};const q=async()=>{W.treeData=[];try{(await e()).result.items.forEach((a=>{W.treeData.push(a)}))}catch(a){}[].forEach((a=>{W.treeData.push(a)}))};return n((()=>{})),m((()=>{q()})),r((()=>{})),i({...c(W)}),(a,e)=>{const d=F("el-button"),t=F("el-tree"),s=F("el-input"),i=F("el-form-item"),o=F("el-form"),n=F("el-dialog");return b(),u("div",E,[f("div",w,[p(d,{type:"primary",onClick:e[0]||(e[0]=a=>y(W).dialogVisible=!0)},{default:g((()=>[v])),_:1})]),p(t,{data:y(W).treeData,props:S,onNodeClick:T,load:I,lazy:""},{default:g((({node:a,data:e})=>[f("span",D,[f("span",null,_(a.label),1),f("span",null,[p(d,{style:{"margin-left":"8px"},onClick:e=>((a,e)=>{W.isEdit=!0,W.addForm.name=a.data.name,W.addForm.fid=a.data.fid,W.addForm.id=a.data.id,W.dialogVisible=!0})(a),type:"text"},{default:g((()=>[M])),_:2},1032,["onClick"]),p(d,{style:{"margin-left":"8px"},onClick:e=>((a,e)=>{C.confirm("确定删除该部门?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{(await l(a.data.id)).success&&(h({type:"success",message:"删除成功"}),q())}))})(a),type:"text"},{default:g((()=>[U])),_:2},1032,["onClick"])])])])),_:1},8,["data"]),p(n,{modelValue:y(W).dialogVisible,"onUpdate:modelValue":e[4]||(e[4]=a=>y(W).dialogVisible=a),title:"部门编辑",onClose:z},{footer:g((()=>[f("span",j,[p(d,{onClick:e[3]||(e[3]=a=>y(W).dialogVisible=!1)},{default:g((()=>[B])),_:1}),p(d,{type:"primary",onClick:y(Z)},{default:g((()=>[N])),_:1},8,["onClick"])])])),default:g((()=>[p(o,{model:y(W).addForm,ref:"addForm"},{default:g((()=>[y(W).isEdit?k("",!0):(b(),V(i,{key:0,label:"父级部门"},{default:g((()=>[p(s,{modelValue:y(x).name,"onUpdate:modelValue":e[1]||(e[1]=a=>y(x).name=a),disabled:""},null,8,["modelValue"])])),_:1})),p(i,{label:"部门名称"},{default:g((()=>[p(s,{modelValue:y(W).addForm.name,"onUpdate:modelValue":e[2]||(e[2]=a=>y(W).addForm.name=a)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-10b036aa"]]);export{T as default};
