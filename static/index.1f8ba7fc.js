import{I as e}from"./const.29417abb.js";import{E as a}from"./index.d01826e7.js";import{G as t,a as l}from"./service.efebec33.js";import{a as r,k as o,m as i,N as n,S as d,r as u,o as s,b as p,e as m,w as b,F as c,n as f,y as v,t as h,f as w,i as g,x as _,_ as C,g as y,$ as D,j as k}from"./index.9c83b174.js";import{g as I}from"./service.a5b2f57a.js";const N={m:"4"},F=r({__name:"versionDetail",props:{priceEvaluationTableList:{type:Array},marketingQuotationData:{type:Object},auditFlowId:{type:Number}},setup(e){const a=e,t=[{title:"核价表",value:1},{title:"报表",value:2}],l=o({mode:1,sopData:[]}),r=e=>{l.mode=e};return i((()=>{})),n((()=>{(async()=>{const{result:e}=await I(a.auditFlowId)||{};l.sopData=e||[]})()})),d((()=>{})),(e,o)=>{const i=u("el-radio"),n=u("el-radio-group"),d=u("el-row"),C=u("el-table-column"),y=u("el-table"),D=u("el-card"),k=u("el-tab-pane"),I=u("el-tabs"),F=u("el-descriptions-item"),x=u("el-descriptions");return s(),p("div",null,[m(d,{style:{"margin-bottom":"20px"}},{default:b((()=>[m(n,{modelValue:l.mode,"onUpdate:modelValue":o[0]||(o[0]=e=>l.mode=e),onChange:r},{default:b((()=>[(s(),p(c,null,f(t,(e=>m(i,{key:e.title,label:e.value,size:"large",border:""},{default:b((()=>[v(h(e.title),1)])),_:2},1032,["label"]))),64))])),_:1},8,["modelValue"])])),_:1}),1===l.mode?(s(),w(I,{key:0,type:"border-card"},{default:b((()=>[(s(!0),p(c,null,f(a.priceEvaluationTableList,((e,a)=>(s(),w(k,{key:a,label:`核价表${a+1}`},{default:b((()=>[v(" 标题："+h(e.title)+" ",1),g("div",N,[m(D,{header:"项目核价表（量产/样品）",m:"2"},{default:b((()=>[m(y,{data:e.material,style:{width:"100%"},border:""},{default:b((()=>[m(C,{type:"index",width:"50"}),m(C,{label:"sap",prop:"sap",width:"180"}),m(C,{label:"材料名称",prop:"materialName",width:"180"}),m(C,{label:"装配数量",prop:"",width:"180"}),m(C,{label:"材料单价（原币）",prop:"assemblyCount",width:"180"}),m(C,{label:"币别",prop:"currencyText",width:"180"}),m(C,{label:"汇率",prop:"exchangeRate",width:"180"}),m(C,{label:"材料单价（人民币）",prop:"materialPriceCyn",width:"180"}),m(C,{label:"合计金额（人民币）",prop:"totalMoneyCyn",width:"180"}),m(C,{label:"损耗",prop:"loss",width:"180"}),m(C,{label:"材料成本（含损耗）",prop:"materialCost",width:"180"}),m(C,{label:"投入量",prop:"inputCount",width:"180"}),m(C,{label:"采购量",prop:"purchaseCount",width:"180"}),m(C,{label:"MOQ分摊成本",prop:"moqShareCount",width:"180"}),m(C,{label:"MOQ",prop:"moq",width:"180"}),m(C,{label:"可用库存",prop:"availableInventory",width:"180"}),m(C,{label:"备注",prop:"remarks",width:"180"})])),_:2},1032,["data"])])),_:2},1024),m(D,{m:"2"},{default:b((()=>[m(y,{data:[e.manufacturingCost],style:{width:"100%"},border:""},{default:b((()=>[m(C,{label:"梯度K/Y（模组数量）",prop:"gradientKy",width:"180"}),m(C,{label:"直接制造成本"},{default:b((()=>[m(C,{label:"直接人工",prop:"manufacturingCostDirect.directLabor"},{default:b((({row:e})=>{var a,t;return[v(h((null==(t=null==(a=e.manufacturingCostDirect)?void 0:a.directLabor)?void 0:t.toFixed(2))||"-"),1)]})),_:1}),m(C,{label:"设备折旧",prop:"manufacturingCostDirect.equipmentDepreciation"},{default:b((({row:e})=>{var a,t;return[v(h((null==(t=null==(a=e.manufacturingCostDirect)?void 0:a.equipmentDepreciation)?void 0:t.toFixed(2))||"-"),1)]})),_:1}),m(C,{label:"换线成本",prop:"manufacturingCostDirect.lineChangeCost"},{default:b((({row:e})=>{var a,t;return[v(h((null==(t=null==(a=e.manufacturingCostDirect)?void 0:a.lineChangeCost)?void 0:t.toFixed(2))||"-"),1)]})),_:1}),m(C,{label:"制造费用",prop:"manufacturingCostDirect.manufacturingExpenses"}),m(C,{label:"小计",prop:"subtotal"})])),_:1}),m(C,{label:"间接制造成本"},{default:b((()=>[m(C,{label:"直接人工",prop:"manufacturingCostIndirect.directLabor"},{default:b((({row:e})=>{var a,t;return[v(h((null==(t=null==(a=e.manufacturingCostIndirect)?void 0:a.directLabor)?void 0:t.toFixed(2))||"-"),1)]})),_:1}),m(C,{label:"设备折旧",prop:"manufacturingCostIndirect.equipmentDepreciation"},{default:b((({row:e})=>{var a,t;return[v(h((null==(t=null==(a=e.manufacturingCostIndirect)?void 0:a.equipmentDepreciation)?void 0:t.toFixed(2))||"-"),1)]})),_:1}),m(C,{label:"换线成本",prop:"manufacturingCostIndirect.lineChangeCost"},{default:b((({row:e})=>{var a,t;return[v(h((null==(t=null==(a=e.manufacturingCostIndirect)?void 0:a.lineChangeCost)?void 0:t.toFixed(2))||"-"),1)]})),_:1}),m(C,{label:"制造费用",prop:"manufacturingCostIndirect.manufacturingExpenses"}),m(C,{label:"小计",prop:"subtotal"})])),_:1}),m(C,{label:"合计",prop:""})])),_:2},1032,["data"])])),_:2},1024),m(D,{m:"2"},{default:b((()=>[m(y,{data:e.lossCost,style:{width:"100%"},border:""},{default:b((()=>[m(C,{label:"成本项目",prop:"name",width:"180"}),m(C,{label:"损耗成本",prop:"wastageCost",width:"180"}),m(C,{label:"MOQ分摊成本",prop:"moqShareCount",width:"180"})])),_:2},1032,["data"])])),_:2},1024),m(D,{m:"2"},{default:b((()=>[m(y,{data:[e.otherCostItem],style:{width:"100%"},border:""},{default:b((()=>[m(C,{label:"夹具",prop:"fixture",width:"180"}),m(C,{label:"物流费",prop:"logisticsFee",width:"180"}),m(C,{label:"质量成本",prop:"qualityCost",width:"180"},{default:b((()=>[m(C,{label:"产品类别",prop:"productCategory",width:"180"}),m(C,{label:"成本比例",prop:"costProportion",width:"180"}),m(C,{label:"质量成本(MAX)",prop:"qualityCost",width:"180"})])),_:1}),m(C,{label:"财务成本",prop:"financialCost",width:"180"},{default:b((()=>[m(C,{label:"账期",prop:"accountingPeriod",width:"180"}),m(C,{label:"资金成本率",prop:"capitalCostRate",width:"180"}),m(C,{label:"财务成本",prop:"financialCost",width:"180"})])),_:1}),m(C,{label:"税务成本",prop:"taxCost",width:"180"}),m(C,{label:"合计",prop:"total",width:"180"})])),_:2},1032,["data"])])),_:2},1024)])])),_:2},1032,["label"])))),128))])),_:1})):_("",!0),m(D,{class:"marketingQuotation-page",header:"报价表"},{default:b((()=>[m(x,{column:2,border:""},{default:b((()=>[m(F,{label:"直接客户名称"},{default:b((()=>{var e;return[v(h(null==(e=a.marketingQuotationData)?void 0:e.directCustomerName),1)]})),_:1}),m(F,{label:"客户性质"},{default:b((()=>{var e;return[v(h(null==(e=a.marketingQuotationData)?void 0:e.clientNature),1)]})),_:1}),m(F,{label:"终端客户名称"},{default:b((()=>{var e;return[v(h(null==(e=a.marketingQuotationData)?void 0:e.terminalCustomerName),1)]})),_:1}),m(F,{label:"终端客户性质"},{default:b((()=>{var e;return[v(h(null==(e=a.marketingQuotationData)?void 0:e.terminalClientNature),1)]})),_:1}),m(F,{label:"开发计划"},{default:b((()=>{var e;return[v(h(null==(e=a.marketingQuotationData)?void 0:e.developmentPlan),1)]})),_:1}),m(F,{label:"汇率"},{default:b((()=>{var e;return[v(h(null==(e=a.marketingQuotationData)?void 0:e.exchangeRate),1)]})),_:1})])),_:1}),m(D,{header:"sop5年内走量信息",m:"2"},{default:b((()=>{var e;return[m(y,{data:null==(e=a.marketingQuotationData)?void 0:e.motionMessage,border:""},{default:b((()=>[m(C,{type:"index",width:"100"}),m(C,{label:"名称",prop:"messageName"}),(s(!0),p(c,null,f(l.sopData,((e,a)=>(s(),w(C,{key:e.year,label:e.year,prop:`sop${a}.value`},null,8,["label","prop"])))),128))])),_:1},8,["data"])]})),_:1}),m(D,{header:"核心部件：",m:"2"},{default:b((()=>{var e;return[(s(!0),p(c,null,f(null==(e=a.marketingQuotationData)?void 0:e.coreComponent,(e=>(s(),w(D,{key:e.messageName,header:e.componentName,class:"m-2"},{default:b((()=>[m(y,{data:e.productSubclass,border:""},{default:b((()=>[m(C,{label:"核心部件",prop:"coreComponent"}),m(C,{label:"型号",prop:"model"}),m(C,{label:"类型",prop:"type"}),m(C,{label:"备注",prop:"remark"})])),_:2},1032,["data"])])),_:2},1032,["header"])))),128))]})),_:1}),m(D,{header:"NRE费用：",m:"2"},{default:b((()=>{var e;return[(s(!0),p(c,null,f(null==(e=a.marketingQuotationData)?void 0:e.nreCost,(e=>(s(),w(D,{key:e.messageName,header:e.nreCostModuleName,class:"m-2"},{default:b((()=>[m(y,{data:e.nreCostModels,border:""},{default:b((()=>[m(C,{type:"index",width:"100"}),m(C,{label:"费用类别",prop:"name"}),m(C,{label:"成本",prop:"cost"})])),_:2},1032,["data"])])),_:2},1032,["header"])))),128))]})),_:1}),m(D,{header:"内部核价信息：",m:"2"},{default:b((()=>{var e;return[(s(!0),p(c,null,f(null==(e=a.marketingQuotationData)?void 0:e.pricingMessage,(e=>(s(),w(D,{key:e.messageName,header:e.pricingMessageName,class:"m-2"},{default:b((()=>[m(y,{data:e.pricingMessageModels,border:""},{default:b((()=>[m(C,{label:"序号",type:"index",width:"100"}),m(C,{label:"费用类别",prop:"name"}),m(C,{label:"成本值",prop:"costValue"})])),_:2},1032,["data"])])),_:2},1032,["header"])))),128))]})),_:1}),m(D,{header:"报价策略：",m:"2"},{default:b((()=>{var e;return[m(y,{data:null==(e=a.marketingQuotationData)?void 0:e.biddingStrategy,border:""},{default:b((()=>[m(C,{type:"index",width:"100"}),m(C,{label:"产品",prop:"product"}),m(C,{label:"成本",prop:"cost"}),m(C,{label:"毛利率",prop:"grossMargin"}),m(C,{label:"样件价格",prop:"price"})])),_:1},8,["data"])]})),_:1}),m(D,{header:"费用表：",m:"2"},{default:b((()=>{var e;return[m(y,{data:null==(e=a.marketingQuotationData)?void 0:e.expensesStatement,border:""},{default:b((()=>[m(C,{type:"index",width:"100"}),m(C,{label:"费用类别",prop:"formName"}),m(C,{label:"核价金额",prop:"offerMoney"}),m(C,{label:"报价系数",prop:"offerCoefficient"}),m(C,{label:"备注",prop:"remark"})])),_:1},8,["data"])]})),_:1})])),_:1})])}}});const x={class:"versionManagement-wrap"},Q=v(" 表单链接 ");var M=C(r({__name:"index",setup(r){const c=k(),f=o({versionManageData:[],verisonfilterNnum:[{label:"项目名称",key:"ProjectName",role:"select",options:[],onchange:async e=>{f.verisonfilterNnum[1].options=f.versionsEnum[e]}},{label:"版本号",key:"Version",role:"select",options:[]},{label:"流程单号",key:"AuditFlowId"},{label:"拟稿时间",key:"DraftDate",role:"timePicker"},{label:"完成时间",key:"FinishedDate",role:"timePicker"}],priceEvaluationTableList:[],visible:!1,versionsEnum:{},marketingQuotationData:null,auditFlowId:null}),w=async e=>{const{DraftDate:a,ProjectName:t,Version:r,AuditFlowId:o,FinishedDate:i}=e,{result:n}=await l({ProjectName:t,Version:r,AuditFlowId:o,DraftStartTime:a[0]||"",DraftEndTime:a[1]||"",FinishedStartTime:i[0]||"",FinishedEndTime:i[1]||""});f.versionManageData=n||[]};return i((()=>{})),n((()=>{(async()=>{const{result:e}=await t();f.verisonfilterNnum[0].options=e.map((e=>{let a={};return a[e.projectName]=e.versions.map((e=>({label:e,value:e}))),f.versionsEnum=a,{label:e.projectName,value:e.projectName}}))})()})),d((()=>{})),(t,l)=>{const r=u("el-button"),o=u("el-table-column"),i=u("el-table"),n=u("el-card"),d=u("el-dialog");return s(),p("div",x,[m(a,{filterNnum:f.verisonfilterNnum,"show-btn":!0,initFilterValue:y(e),onSubmit:w},null,8,["filterNnum","initFilterValue"]),m(n,{class:"table-wrap",header:"系统版本管理表"},{default:b((()=>[m(i,{data:f.versionManageData,style:{width:"100%"}},{default:b((()=>[m(o,{prop:"versionBasicInfo.projectName",label:"项目名称"},{default:b((({row:e})=>[m(r,{type:"primary",link:"",onClick:a=>{var t,l;return l=null==(t=e.versionBasicInfo)?void 0:t.auditFlowId,void c.push(`/versionManagement/operationRecord?AuditFlowId=${l}`).catch((e=>{console.warn(e)}))}},{default:b((()=>[v(h(e.versionBasicInfo.projectName),1)])),_:2},1032,["onClick"])])),_:1}),m(o,{prop:"versionBasicInfo.version",label:"版本号"}),m(o,{prop:"versionBasicInfo.auditFlowId",label:"流程单号"}),m(o,{label:"拟稿时间"},{default:b((({row:e})=>[v(h(y(D)(e.versionBasicInfo.draftTime||"")),1)])),_:1}),m(o,{label:"完成时间"},{default:b((({row:e})=>[v(h(y(D)(e.versionBasicInfo.finishedTime||"")),1)])),_:1}),m(o,{label:"操作",fixed:"right"},{default:b((({row:e})=>[m(r,{onClick:a=>(({priceEvaluationTableList:e,quotationTable:a,auditFlowId:t})=>{f.priceEvaluationTableList=e,f.marketingQuotationData=a,f.auditFlowId=t,f.visible=!0})(e),type:"primary",link:""},{default:b((()=>[Q])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])),_:1}),m(d,{title:"报表汇总",width:"80%",modelValue:f.visible,"onUpdate:modelValue":l[0]||(l[0]=e=>f.visible=e)},{default:b((()=>[m(F,{priceEvaluationTableList:f.priceEvaluationTableList,marketingQuotationData:f.marketingQuotationData,auditFlowId:f.auditFlowId},null,8,["priceEvaluationTableList","marketingQuotationData","auditFlowId"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-07b418a6"]]);export{M as default};
