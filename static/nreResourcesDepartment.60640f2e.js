import{d as e,e as a,f as o}from"./request.578b9ba3.js";import{g as t}from"./mouldSummaries.62f35173.js";import{g as l}from"./getQuery.b59b1282.js";import{_ as s,a as r,k as u,m as d,N as n,S as m,f as c,w as i,r as p,o as y,e as f,g as h,b,t as w,y as V,i as g,I as v,E as _,X as I}from"./index.c6c04119.js";const D={key:1},M={style:{float:"right",margin:"20px 0"}},U=V("计算"),C=V("提交");var N=s(r({__name:"nreResourcesDepartment",setup(s){const{auditFlowId:r,productId:N}=l(),k=u({resourceData:[],resourcesManagementModels:[]}),j=async()=>{const{success:e}=await a({auditFlowId:r,resourcesManagementModels:{mouldInventory:k.resourceData.map((e=>({...e,cost:(e.unitPrice||0)*(e.count||0)}))),productId:N}});e&&_.success("提交成功！")},x=async()=>{try{const{result:e,success:a}=await o({mouldInventory:k.resourceData,productId:N});a||_.success("计算成功");const{mouldInventory:t=[]}=e||[];k.resourceData=t.map(((e,a)=>"吸塑/包材"===e.modelName?k.resourceData[a]:e))}catch(e){_.error("计算失败")}};return d((()=>{})),n((()=>{(async()=>{const{result:a}=await e(r,N);k.resourceData=(null==a?void 0:a.mouldInventoryModels)||[],k.resourcesManagementModels=null==a?void 0:a.mouldInventoryModels})()})),m((()=>{})),(e,a)=>{const o=p("el-table-column"),l=p("el-input-number"),s=p("el-table"),r=p("el-button"),u=p("el-card"),d=I("havedone");return y(),c(u,null,{default:i((()=>[f(u,{class:"margin-top"},{default:i((()=>[f(s,{data:k.resourceData,border:"","summary-method":h(t),"show-summary":"",height:"72vh"},{default:i((()=>[f(o,{type:"index",width:"50"}),f(o,{label:"模具名称",prop:"modelName",width:"180"}),f(o,{label:"模穴数",width:"180"},{default:i((({row:e})=>[f(l,{modelValue:e.moldCavityCount,"onUpdate:modelValue":a=>e.moldCavityCount=a,min:0,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),f(o,{label:"模次数",width:"180"},{default:i((({row:e})=>[f(l,{modelValue:e.modelNumber,"onUpdate:modelValue":a=>e.modelNumber=a,min:0,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),f(o,{label:"数量",prop:"count",width:"180"},{default:i((({row:e})=>["吸塑/包材"===e.modelName?(y(),c(l,{key:0,modelValue:e.count,"onUpdate:modelValue":a=>e.count=a,"controls-position":"right",min:0},null,8,["modelValue","onUpdate:modelValue"])):(y(),b("div",D,w(e.count),1))])),_:1}),f(o,{label:"单价",width:"180"},{default:i((({row:e})=>[f(l,{modelValue:e.unitPrice,"onUpdate:modelValue":a=>e.unitPrice=a,min:0,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),f(o,{label:"费用"},{default:i((({row:e})=>[V(w(e.unitPrice*e.count),1)])),_:1})])),_:1},8,["data","summary-method"]),g("div",M,[v((y(),c(r,{type:"primary",onClick:x},{default:i((()=>[U])),_:1})),[[d]]),v((y(),c(r,{type:"primary",onClick:j},{default:i((()=>[C])),_:1})),[[d]])])])),_:1})])),_:1})}}}),[["__scopeId","data-v-6c8dff62"]]);export{N as default};
