import{g as a,a as e,b as s,s as t}from"./service.055ff2e2.js";import{g as l}from"./getQuery.39609eb8.js";import{_ as o}from"./lodash.3a81bb3a.js";import{_ as r,a as d,k as i,m as c,N as u,S as m,W as p,b,e as n,w as y,r as f,o as h,F as w,n as L,f as E,i as I,I as _,y as g,E as v,X as D,z as x,A as R}from"./index.579ec607.js";const Y={class:"bom-loss"},F=(a=>(x("data-v-6bfe4133"),a=a(),R(),a))((()=>I("div",{class:"card-header"},[I("span",null,"电子料bom损耗率表单")],-1))),N=g("%"),j={style:{float:"right",margin:"20px 0"}},V=g("提交");var k=r(d({__name:"indexElec",setup(r,{expose:d}){const g=i({bomLossElecData:[],years:[]});let x=0,R=0;const k=async()=>{let a=[];a=o.cloneDeep(g.bomLossElecData);let e=a.map((a=>({...a,lossRateYearList:a.lossRateYearList.map((a=>({year:a.year,rate:(Number(a.rate)/100).toFixed(4)})))})));(await t(e)).success&&v({type:"success",message:"提交成功"})};return c((()=>{})),u((async()=>{let t=l();x=t.auditFlowId?Number(t.auditFlowId):0,R=t.productId?Number(t.productId):0;let o=t.right,{result:r}=await a(x);if(g.years=r,"1"===o){let a=await e({auditFlowId:x,productId:R});g.bomLossElecData=a.result,g.bomLossElecData.forEach((a=>{a.lossRateYearList.forEach((a=>{a.rate=100*Number(a.rate)}))}))}else{let a=await s({auditFlowId:x,productId:R});g.bomLossElecData=a.result,g.bomLossElecData.forEach((a=>{a.lossRateYearList=[],a.lossRateYearList=g.years.map((a=>({year:a,rate:""})))}))}})),m((()=>{})),d({...p(g)}),(a,e)=>{const s=f("el-table-column"),t=f("el-input"),l=f("el-table"),o=f("el-button"),r=f("el-card"),d=D("havedone");return h(),b("div",Y,[n(r,{class:"card"},{header:y((()=>[F])),default:y((()=>[n(l,{data:g.bomLossElecData,border:"",style:{width:"100%"},height:"500"},{default:y((()=>[n(s,{type:"index",width:"50"}),n(s,{prop:"superType",label:"种类",width:"180"}),n(s,{prop:"categoryName",label:"物料大类",width:"180"}),(h(!0),b(w,null,L(g.years,((a,e)=>(h(),E(s,{label:a+"",key:a},{default:y((({row:a})=>[n(t,{modelValue:a.lossRateYearList[e].rate,"onUpdate:modelValue":s=>a.lossRateYearList[e].rate=s,type:"number"},{append:y((()=>[N])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["label"])))),128))])),_:1},8,["data"]),I("div",j,[_((h(),E(o,{type:"primary",onClick:k},{default:y((()=>[V])),_:1})),[[d]])])])),_:1})])}}}),[["__scopeId","data-v-6bfe4133"]]);export{k as default};
