import{G as a}from"./service.e6b61cc5.js";import{g as e}from"./getQuery.06af59d7.js";import{g as t}from"./service.54294400.js";import{P as o}from"./service.014fdda6.js";import{_ as l,a as r,k as n,m as s,N as i,S as d,f as m,w as p,r as u,o as c,e as g,y as f,t as b,b as _,n as k,F as h,E as y}from"./index.ad8f3002.js";const D=f("保存");var Q=l(r({__name:"result",setup(l){const{auditFlowId:r=1}=e(),Q=n({projectName:"",developmentPlan:"",marketingQuotationData:{},motionMessageSop:[]}),w=n({sopData:[]});s((()=>{})),i((()=>{M(),v()}));const M=async()=>{const{result:e}=await a({Id:r});Q.marketingQuotationData=e,Q.motionMessageSop=e.motionMessage[0].sop.map((a=>a))},v=async()=>{const{result:a}=await t(r)||{};w.sopData=a||[]},C=async()=>{const{success:a}=await o({auditFlowId:r,...Q.marketingQuotationData})||{};a&&y.success("保存成功！")};return d((()=>{})),(a,e)=>{const t=u("el-descriptions-item"),o=u("el-input"),l=u("el-descriptions"),r=u("el-table-column"),n=u("el-table"),s=u("el-card"),i=u("el-input-number"),d=u("el-button"),y=u("el-row");return c(),m(s,{class:"marketingQuotation-page",header:"报价审核",m:"2"},{default:p((()=>[g(l,{column:2,border:""},{default:p((()=>[g(t,{label:"直接客户名称"},{default:p((()=>[f(b(Q.marketingQuotationData.directCustomerName),1)])),_:1}),g(t,{label:"客户性质"},{default:p((()=>[f(b(Q.marketingQuotationData.clientNature),1)])),_:1}),g(t,{label:"终端客户名称"},{default:p((()=>[f(b(Q.marketingQuotationData.terminalCustomerName),1)])),_:1}),g(t,{label:"终端客户性质"},{default:p((()=>[f(b(Q.marketingQuotationData.terminalClientNature),1)])),_:1}),g(t,{label:"开发计划"},{default:p((()=>[g(o,{modelValue:Q.marketingQuotationData.developmentPlan,"onUpdate:modelValue":e[0]||(e[0]=a=>Q.marketingQuotationData.developmentPlan=a)},null,8,["modelValue"])])),_:1}),g(t,{label:"汇率"},{default:p((()=>[f(b(Q.marketingQuotationData.exchangeRate),1)])),_:1})])),_:1}),g(s,{header:"sop5年内走量信息",m:"2"},{default:p((()=>[g(n,{data:Q.marketingQuotationData.motionMessage,border:""},{default:p((()=>[g(r,{type:"index",width:"100"}),g(r,{label:"名称",prop:"messageName"}),(c(!0),_(h,null,k(Q.motionMessageSop,((a,e)=>(c(),m(r,{key:a.year,label:a.year,prop:`sop[${e}].value`},null,8,["label","prop"])))),128))])),_:1},8,["data"])])),_:1}),g(s,{header:"核心部件：",m:"2"},{default:p((()=>[(c(!0),_(h,null,k(Q.marketingQuotationData.coreComponent,(a=>(c(),m(s,{key:a.messageName,header:a.componentName,class:"m-2"},{default:p((()=>[g(n,{data:a.productSubclass,border:""},{default:p((()=>[g(r,{label:"核心部件",prop:"coreComponent"}),g(r,{label:"型号",prop:"model"}),g(r,{label:"类型",prop:"type"}),g(r,{label:"备注",prop:"remark"})])),_:2},1032,["data"])])),_:2},1032,["header"])))),128))])),_:1}),g(s,{header:"NRE费用：",m:"2"},{default:p((()=>[(c(!0),_(h,null,k(Q.marketingQuotationData.nreCost,(a=>(c(),m(s,{key:a.messageName,header:a.nreCostModuleName,class:"m-2"},{default:p((()=>[g(n,{data:a.nreCostModels,border:""},{default:p((()=>[g(r,{type:"index",width:"100"}),g(r,{label:"费用类别",prop:"name"}),g(r,{label:"成本",prop:"cost"})])),_:2},1032,["data"])])),_:2},1032,["header"])))),128))])),_:1}),g(s,{header:"内部核价信息：",m:"2"},{default:p((()=>[(c(!0),_(h,null,k(Q.marketingQuotationData.pricingMessage,(a=>(c(),m(s,{key:a.messageName,header:a.pricingMessageName,class:"m-2"},{default:p((()=>[g(n,{data:a.pricingMessageModels,border:""},{default:p((()=>[g(r,{label:"序号",type:"index",width:"100"}),g(r,{label:"费用类别",prop:"name"}),g(r,{label:"成本值",prop:"costValue"})])),_:2},1032,["data"])])),_:2},1032,["header"])))),128))])),_:1}),g(s,{header:"报价策略：",m:"2"},{default:p((()=>[g(n,{data:Q.marketingQuotationData.biddingStrategy,border:""},{default:p((()=>[g(r,{type:"index",width:"100"}),g(r,{label:"产品",prop:"product"}),g(r,{label:"成本",prop:"cost"}),g(r,{label:"毛利率",prop:"grossMargin"},{default:p((({row:a})=>{var e;return[f(b(`${(null==(e=100*a.grossMargin)?void 0:e.toFixed(2))||0} %`),1)]})),_:1}),g(r,{label:"价格",prop:"price"}),g(r,{label:"佣金",prop:"commission",width:"180"},{default:p((a=>[g(i,{"controls-position":"right",modelValue:a.row.commission,"onUpdate:modelValue":e=>a.row.commission=e,placeholder:"请输入佣金",onChange:e=>{return t=a.row,o=a.$index,void(Q.marketingQuotationData.biddingStrategy[o].grossMarginCommission=(t.price-t.commission-t.cost)/(t.cost+t.commission));var t,o},min:0},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),g(r,{label:"含佣金的毛利率",prop:"grossMarginCommission"},{default:p((({row:a})=>{var e;return[f(b(`${(null==(e=100*a.grossMarginCommission)?void 0:e.toFixed(2))||0} %`),1)]})),_:1})])),_:1},8,["data"])])),_:1}),g(s,{header:"费用表：",m:"2"},{default:p((()=>[g(n,{data:Q.marketingQuotationData.expensesStatement,border:""},{default:p((()=>[g(r,{type:"index",width:"100"}),g(r,{label:"费用类别",prop:"formName"}),g(r,{label:"核价金额",prop:"offerMoney"}),g(r,{label:"报价系数",prop:"offerCoefficient"}),g(r,{label:"报价金额",prop:"offerMoney"}),g(r,{label:"备注",prop:"remark"})])),_:1},8,["data"])])),_:1}),g(y,{justify:"end",m:"2"},{default:p((()=>[g(d,{onClick:C,type:"primary"},{default:p((()=>[D])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-76598ef8"]]);export{Q as default};
