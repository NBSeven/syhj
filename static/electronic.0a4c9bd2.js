import{G as a,S as e}from"./service.d5ee8845.js";import{g as l}from"./service.ab3796d8.js";import{g as r}from"./service.a5b2f57a.js";import{g as t}from"./getQuery.bab2d130.js";import{u as s}from"./useJump.7cb97b86.js";import{_ as n,a as o,M as u,k as i,m as p,N as d,S as c,f as y,w as m,r as v,o as b,e as w,I as f,b as h,n as C,i as g,t as _,F as k,y as I,x as Y,Z as $,X as T}from"./index.9c83b174.js";const j=I("同意"),M=I("拒绝");var x=n(o({__name:"electronic",setup(n){const{jumpTodoCenter:o}=s(),{auditFlowId:x=1,productId:N}=t(),R=u([]),U=u(!0),F=i({sop:[]}),B=i({auditFlowId:x,productId:N}),S=u([]);p((()=>{A(),G()})),d((()=>{D()}));const A=async()=>{try{U.value=!0;const a=await l({maxResultCount:100,skipCount:0});S.value=a.result.items||[],U.value=!1}catch{U.value=!1}},D=async()=>{const{result:e}=await a(x,N);R.value=e;const{materialsUseCount:l,systemiginalCurrency:r,inTheRate:t,iginalCurrency:s,standardMoney:n}=(null==R?void 0:R.value[0])||{};F.materialsUseCountYears=(null==l?void 0:l.map((a=>a.year)))||[],F.systemiginalCurrencyYears=(null==r?void 0:r.map((a=>a.year)))||[],F.inTheRateYears=(null==t?void 0:t.map((a=>a.year)))||[],F.iginalCurrencyYears=(null==s?void 0:s.map((a=>a.year)))||[],F.standardMoneyYears=(null==n?void 0:n.map((a=>a.year)))||[]},G=async()=>{const{result:a}=await r(x)||{};F.sop=a||[]},J=a=>{let l=a?"您确定要同意嘛？":"请输入拒绝理由";$[a?"confirm":"prompt"](l,"请审核",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async l=>{const{success:r}=await e({isAgree:a,auditFlowId:x,bomCheckType:3,opinionDescription:a?"":null==l?void 0:l.value});r&&o()}))};return c((()=>{})),(a,e)=>{const l=v("el-table-column"),r=v("el-table"),t=v("el-card"),s=v("el-button"),n=v("el-row"),o=T("loading"),u=T("havedone");return b(),y(t,{class:"wrap m-2"},{default:m((()=>[w(t,{class:"table-wrap",header:"电子料单价"},{default:m((()=>[f((b(),y(r,{data:R.value,style:{width:"100%"},height:"75vh"},{default:m((()=>[w(l,{prop:"categoryName",label:"物料大类",width:"150"}),w(l,{prop:"typeName",label:"物料种类",width:"150"}),w(l,{prop:"sapItemNum",label:"物料编号",width:"150"}),w(l,{prop:"sapItemName",label:"材料名称",width:"150"}),w(l,{prop:"materialsUseCount",label:"项目物料的使用量"},{default:m((()=>[(b(!0),h(k,null,C(null==F?void 0:F.materialsUseCountYears,((a,e)=>(b(),y(l,{key:a,label:`${a}`,prop:`materialsUseCount[${e}].value`,width:"150"},{default:m((a=>[g("span",null,_(a.row.materialsUseCount[e].value),1)])),_:2},1032,["label","prop"])))),128))])),_:1}),w(l,{prop:"currency",label:"币种",width:"150"}),w(l,{prop:"systemiginalCurrency",label:"系统单价（原币）"},{default:m((()=>[(b(!0),h(k,null,C(null==F?void 0:F.systemiginalCurrencyYears,((a,e)=>(b(),y(l,{key:a,label:`${a}`,prop:`systemiginalCurrency[${e}].value`,width:"150"},{default:m((a=>[g("span",null,_(a.row.systemiginalCurrency[e].value),1)])),_:2},1032,["label","prop"])))),128))])),_:1}),w(l,{prop:"inTheRate",label:"年降率"},{default:m((()=>[(b(!0),h(k,null,C(null==F?void 0:F.inTheRateYears,((a,e)=>(b(),y(l,{key:a,label:`${a}`,prop:`inTheRate[${e}].value`,width:"150"},null,8,["label","prop"])))),128))])),_:1}),w(l,{prop:"iginalCurrency",label:"原币"},{default:m((()=>[(b(!0),h(k,null,C(null==F?void 0:F.iginalCurrencyYears,((a,e)=>(b(),y(l,{key:a,label:`${a}`,prop:`iginalCurrency[${e}].value`,width:"150"},{default:m((({row:a})=>{var l;return[I(_((null==(l=a.iginalCurrency[e])?void 0:l.value)||0),1)]})),_:2},1032,["label","prop"])))),128))])),_:1}),w(l,{prop:"standardMoney",label:"本位币"},{default:m((()=>[(b(!0),h(k,null,C(null==F?void 0:F.standardMoneyYears,((a,e)=>(b(),y(l,{key:a,label:`${a}`,prop:`standardMoney[${e}].value`,width:"150"},{default:m((({row:a})=>{var l;return[I(_((null==(l=a.standardMoney[e])?void 0:l.value)||0),1)]})),_:2},1032,["label","prop"])))),128))])),_:1}),w(l,{prop:"rebateMoney",label:"物料返利金额",width:"150"}),w(l,{prop:"remark",label:"备注"}),w(l,{prop:"peopleName",label:"确认人"})])),_:1},8,["data"])),[[o,U.value]])])),_:1}),B.auditFlowId&&B.productId?(b(),y(n,{key:0,justify:"end",style:{"margin-top":"20px"}},{default:m((()=>[f((b(),y(s,{type:"primary",onClick:e[0]||(e[0]=a=>J(!0))},{default:m((()=>[j])),_:1})),[[u]]),f((b(),y(s,{type:"danger",onClick:e[1]||(e[1]=a=>J(!1))},{default:m((()=>[M])),_:1})),[[u]])])),_:1})):Y("",!0)])),_:1})}}}),[["__scopeId","data-v-7f2d2040"]]);export{x as default};
