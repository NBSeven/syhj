import{g as e}from"./getQuery.336943ac.js";import{_ as l,a,M as t,k as o,V as u,l as r,N as d,W as n,b as p,e as i,w as m,r as s,o as c,I as f,f as y,F as V,n as b,i as g,g as _,y as h,t as q,u as T,j as C,E as F,X as v,z as U,A as w}from"./index.91226b5a.js";import{_ as S}from"./lodash.36183a83.js";import{g as N,a as O,s as D}from"./service.06760ab4.js";import{g as P}from"./dictionary.6c84d364.js";import{_ as k}from"./index.02aebef7.js";import{h as j,a as x}from"./upload.e57b9fe1.js";import"./user.7df87fa1.js";const Y="1";const M=e=>(U("data-v-7d829631"),e=e(),w(),e),L={class:"demand-apply"},R=h("自动生成"),E=M((()=>g("h5",null,"项目走量",-1))),A=M((()=>g("h6",null,"终端走量（单位：PCS）",-1))),I={class:"demand-apply__btn-container"},Q=h("新增"),$=h(" 删除 "),J=M((()=>g("h6",null,"模组数量",-1))),z={class:"demand-apply__btn-container"},B=h("新增模组"),H=h("%"),K=h("%"),W=h("删除"),X=M((()=>g("h6",null,"要求",-1))),Z=h("%"),G=h("%"),ee=h("%"),le=M((()=>g("h6",null,"产品信息",-1))),ae=h("元"),te=h("元"),oe=h("元"),ue=h("元"),re=h("元"),de=h("元"),ne=h("元"),pe=M((()=>g("h6",null,"客户指定/供应详情",-1))),ie=h("点击生成"),me=h("SOR文件上传"),se=h("提交");var ce=l(a({__name:"index",setup(l,{expose:a}){const U=t(),w=o({projectName:[{required:!0,message:"请输入该值",trigger:"blur"}],projectCode:[{required:!0,message:"请输入该值",trigger:"blur"}],customerName:[{required:!0,message:"请输入该值",trigger:"blur"}],customerNature:[{required:!0,message:"请输入该值",trigger:"blur"}],country:[{required:!0,message:"请输入该值",trigger:"blur"}],quotationType:[{required:!0,message:"请输入该值",trigger:"blur"}],sopTime:[{required:!0,message:"请输入该值",trigger:"blur"}],projectCycle:[{required:!0,message:"请输入该值",trigger:"blur"}],allocationOfMouldCost:[{required:!0,message:"请输入该值",trigger:"blur"}],allocationOfFixtureCost:[{required:!0,message:"请输入该值",trigger:"blur"}],allocationOfEquipmentCost:[{required:!0,message:"请输入该值",trigger:"blur"}],reliabilityCost:[{required:!0,message:"请输入该值",trigger:"blur"}],developmentCost:[{required:!0,message:"请输入该值",trigger:"blur"}],landingFactory:[{required:!0,message:"请输入该值",trigger:"blur"}],tradeMode:[{required:!0,message:"请输入该值",trigger:"blur"}],salesType:[{required:!0,message:"请输入该值",trigger:"blur"}],paymentMethod:[{required:!0,message:"请输入该值",trigger:"blur"}],currency:[{required:!0,message:"请输入该值",trigger:"blur"}],customerTargetPrice:[{required:!0,message:"请输入该值",trigger:"blur"}],customerSpecialRequest:[{required:!0,message:"请输入该值",trigger:"blur"}],shippingType:[{required:!0,message:"请输入该值",trigger:"blur"}],packagingType:[{required:!0,message:"请输入该值",trigger:"blur"}],placeOfDelivery:[{required:!0,message:"请输入该值",trigger:"blur"}],deadline:[{required:!0,message:"请输入该值",trigger:"blur"}],projectManager:[{required:!0,message:"请输入该值",trigger:"blur"}],sorFile:[{required:!0,message:"请输入该值",trigger:"blur"}]}),M=e=>{const{columns:l,data:a}=e,t=[];let o=new Array(a[0].pcsYearList.length).fill(0).map((()=>[]));return a.forEach((e=>{e.pcsYearList.forEach(((e,l)=>{var a;null==(a=o[l])||a.push(Number(e.quantity))}))})),l.forEach(((e,l)=>{var a;if(0!==l)if(l>=2){let e=l-2;t[l]=null==(a=o[e])?void 0:a.reduce(((e,l)=>e+l))}else t[l]="N/A";else t[l]="合计"})),be.sumArr=[],t.forEach((e=>{"number"==typeof e&&be.sumArr.push(e)})),be.sumArr.length>0&&(be.carAnnualTotal=be.sumArr.reduce(((e,l)=>e+l))),t};let ce=window.localStorage.getItem("user"),fe=ce?JSON.parse(ce):{},ye=!1;const Ve=e=>{if(Array.isArray(e.pcsYearList)&&e.pcsYearList.length>0)return e.pcsYearList.map((e=>e.quantity)).reduce(((e,l)=>Number(e)+Number(l)))},be=o({quoteForm:{title:"",drafter:"",drafterNumber:null,draftingDepartment:"",draftingCompany:"",draftDate:new Date,number:"",projectName:"",projectCode:"",customerName:"",customerNature:"",country:"",terminalName:"",terminalNature:"",quotationType:"",sopTime:u(new Date).format("YYYY"),projectCycle:0,pcs:[],modelCount:[],requirement:[],allocationOfMouldCost:!0,allocationOfFixtureCost:!0,allocationOfEquipmentCost:!0,reliabilityCost:!0,developmentCost:!0,landingFactory:"",productInformation:[],tradeMode:"",salesType:"",paymentMethod:"",currency:"",customerTargetPrice:0,exchangeRate:0,customerSpecialRequest:"",shippingType:"",packagingType:"",placeOfDelivery:"",deadline:new Date,projectManager:void 0,sorFile:[],reason:"",auditFlowId:1},quoteVersion:"",yearCols:[],carAnnualTotal:0,sumArr:[],customerNatureOptions:[],terminalNatureOptions:[],quotationTypeOptions:[],sampleQuotationTypeOptions:[],countryOptions:[],productOptions:[],productTypeOptions:[],allocationOfMouldCostOptions:[],allocationOfFixtureCostOptions:[],allocationOfEquipmentCostOptions:[],reliabilityCostOptions:[],developmentCostOptions:[],landingFactoryOptions:[],salesTypeOptions:[],currencyOptions:[],shippingTypeOptions:[],packagingTypeOptions:[],TypeSelectOptions:[],TradeMethodOptions:[],ExchangeSelectOptions:[]}),ge=t([]),_e=t(0);let he=T(),qe=C();let Te=t([{carFactory:"",carModel:"",pcsYearList:[],sum:0}]),Ce=t([{partNumber:"",product:"",productType:0,marketShare:0,moduleCarryingRate:0,singleCarProductsQuantity:0,modelTotal:0,modelCountYearList:[]}]),Fe=t([]),ve=t([{name:"",sensor:"",sensorTypeSelect:"1",sensorPrice:0,lens:"",lensTypeSelect:"1",lensPrice:0,isp:"",ispTypeSelect:"1",ispPrice:0,serialChip:"",serialChipTypeSelect:"1",serialChipPrice:0,cable:"",cableTypeSelect:"1",cablePrice:0,led:"",ledTypeSelect:"1",ledPrice:0,manufactureProcess:"",installationPosition:"",product:""}]),Ue=t([]);const we=()=>{Te.value.push(S.cloneDeep(Te.value[0]))},Se=()=>{ve.value.push(Object.assign(S.cloneDeep(ve.value[0]),{name:"",sensor:"",sensorTypeSelect:"1",sensorPrice:0,lens:"",lensTypeSelect:"1",lensPrice:0,isp:"",ispTypeSelect:"1",ispPrice:0,serialChip:"",serialChipTypeSelect:"1",serialChipPrice:0,cable:"",cableTypeSelect:"1",cablePrice:0,led:"",ledTypeSelect:"1",ledPrice:0,manufactureProcess:"",installationPosition:""}));let e=Object.assign(S.cloneDeep(Ce.value[0]),{partNumber:"",product:"",productType:0,marketShare:0,moduleCarryingRate:0,singleCarProductsQuantity:0,modelTotal:0});e.modelCountYearList.forEach((e=>{e.quantity=""})),Ce.value.push(e),ve.value.forEach(((e,l)=>{e.name=Ce[l].product,e.product=Ce[l].product}))},Ne=e=>{if(e){_e.value=e;let l=be.quoteForm.projectCycle;be.yearCols=[],be.quoteForm.sopTime;for(let e=0;e<l;e++)be.yearCols.push(Number(be.quoteForm.sopTime)+e)}};r((()=>be.yearCols),(e=>{ye||(Te.value.forEach((l=>{l.pcsYearList=e.map((e=>({year:e,quantity:null})))})),Ce.value.forEach((l=>{l.modelCountYearList=e.map((e=>({year:e,quantity:null})))})),Fe.value.splice(0,Fe.value.length),e.forEach((e=>{Fe.value.push({year:e,annualDeclineRate:0,annualRebateRequirements:0,oneTimeDiscountRate:0})})))})),r(Ce,(e=>{e.forEach(((e,l)=>{ve.value[l].name=e.product,ve.value[l].product=e.product,Ce.value.forEach((e=>{e.modelCountYearList.forEach(((l,a)=>{e.marketShare&&e.moduleCarryingRate&&e.singleCarProductsQuantity&&be.sumArr[a]&&(l.quantity=e.marketShare*e.moduleCarryingRate*e.singleCarProductsQuantity*be.sumArr[a]/1e4)}))})),e.marketShare&&e.moduleCarryingRate&&e.singleCarProductsQuantity&&be.carAnnualTotal&&(e.modelTotal=e.marketShare*e.moduleCarryingRate*e.singleCarProductsQuantity*be.carAnnualTotal/1e4)}))}),{deep:!0});const Oe=e=>{},De=(e,l)=>{},Pe=()=>{let{quoteForm:e}=be,l=`${u(e.draftDate?e.draftDate:new Date).format("YYYY-MM-DD")+e.draftingDepartment}关于${e.customerName+e.projectName+"第"+be.quoteVersion+"版"}的核价报价申请`;be.quoteForm.title=l},ke=()=>{Ue.value.splice(0,Ue.value.length),ve.value.forEach((e=>{if(e.sensorTypeSelect!==Y){let l=e.sensorPrice,a=e.name,t="sensor",o=e.sensor,u="2"===e.sensorTypeSelect?"客户指定":"客户供应";Ue.value.push({price:l,productName:a,main:t,type:o,productType:u})}if(e.lensTypeSelect!==Y){let l=e.lensPrice,a=e.name,t="lens",o=e.lens,u="2"===e.lensTypeSelect?"客户指定":"客户供应";Ue.value.push({price:l,productName:a,main:t,type:o,productType:u})}if(e.ispTypeSelect!==Y){let l=e.ispPrice,a=e.name,t="isp",o=e.isp,u="2"===e.ispTypeSelect?"客户指定":"客户供应";Ue.value.push({price:l,productName:a,main:t,type:o,productType:u})}if(e.serialChipTypeSelect!==Y){let l=e.serialChipPrice,a=e.name,t="serialChip",o=e.serialChip,u="2"===e.serialChipTypeSelect?"客户指定":"客户供应";Ue.value.push({price:l,productName:a,main:t,type:o,productType:u})}if(e.ledTypeSelect!==Y){let l=e.ledPrice,a=e.name,t="led",o=e.led,u="2"===e.ledTypeSelect?"客户指定":"客户供应";Ue.value.push({price:l,productName:a,main:t,type:o,productType:u})}}))},je=e=>{be.ExchangeSelectOptions.forEach((l=>{l.id===e&&l.exchangeRateValue.forEach((e=>{e.year===Number(be.quoteForm.sopTime)&&(be.quoteForm.exchangeRate=e.value)}))}))};return d((async()=>{var l,a;let t=e();be.quoteForm.projectName=t.projectName?t.projectName+"":"",be.quoteForm.projectCode=t.projectCode?t.projectCode+"":"",be.quoteVersion=t.quoteVersion?t.quoteVersion+"":"",be.quoteForm.drafter=fe.name,be.quoteForm.drafterNumber=fe.userNumber||"未成功获取",be.quoteForm.draftingCompany=(null==(l=fe.userCompany)?void 0:l.name)||"未成功获取",be.quoteForm.draftingDepartment=(null==(a=fe.userDepartment)?void 0:a.name)||"未成功获取",(()=>{let{quoteForm:e}=be,l="BJHJ-ZL"+u(e.draftDate?e.draftDate:new Date).format("YYYYMMDD")+"-001";e.number=l})();try{let e=await P("CustomerNature");be.customerNatureOptions=e.result.financeDictionaryDetailList;let l=await P("TerminalNature");be.terminalNatureOptions=l.result.financeDictionaryDetailList;let a=await P("QuotationType");be.quotationTypeOptions=a.result.financeDictionaryDetailList;let t=await P("Country");be.countryOptions=t.result.financeDictionaryDetailList;let o=await P("ProductType");be.productTypeOptions=o.result.financeDictionaryDetailList;let u=await P("LandingFactory");be.landingFactoryOptions=u.result.financeDictionaryDetailList;let r=await P("SalesType");be.salesTypeOptions=r.result.financeDictionaryDetailList;let d=await P("Currency");be.currencyOptions=d.result.financeDictionaryDetailList;let n=await P("ShippingType");be.shippingTypeOptions=n.result.financeDictionaryDetailList;let p=await P("PackagingType");be.packagingTypeOptions=p.result.financeDictionaryDetailList;let i=await P("TypeSelect");be.TypeSelectOptions=i.result.financeDictionaryDetailList;let m=await P("TradeMethod");be.TradeMethodOptions=m.result.financeDictionaryDetailList;let s=await N({maxResultCount:100,skipCount:0});be.ExchangeSelectOptions=s.result.items}catch(o){}if(t.auditFlowId){let e=await O(t.auditFlowId);if(e.result){ye=!0,be.quoteForm=e.result;const l=[e.result.sopTime];be.quoteForm.sopTime=u(l).format("YYYY"),Te.value=e.result.pcs,Ne(e.result.projectCycle),ve.value=e.result.productInformation,Ce.value=e.result.modelCount,Fe.value=e.result.requirement}setTimeout((()=>{ye=!1}),2e3)}})),a({...n(be)}),(e,l)=>{const a=s("el-button"),t=s("el-input"),o=s("el-form-item"),u=s("el-col"),r=s("el-date-picker"),d=s("el-row"),n=s("el-card"),T=s("el-option"),C=s("el-select"),S=s("el-input-number"),N=s("el-table-column"),O=s("el-table"),P=s("el-upload"),Y=s("el-form"),ce=v("havedone");return c(),p("div",L,[i(Y,{model:be.quoteForm,ref_key:"refForm",ref:U,rules:w},{default:m((()=>[i(n,{class:"demand-apply__card"},{default:m((()=>[i(d,{gutter:20},{default:m((()=>[i(u,{span:24},{default:m((()=>[i(o,{label:"标题:",prop:"title"},{default:m((()=>[i(t,{modelValue:be.quoteForm.title,"onUpdate:modelValue":l[0]||(l[0]=e=>be.quoteForm.title=e)},{append:m((()=>[f((c(),y(a,{onClick:Pe},{default:m((()=>[R])),_:1})),[[ce]])])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"拟稿人:",prop:"drafter"},{default:m((()=>[i(t,{modelValue:be.quoteForm.drafter,"onUpdate:modelValue":l[1]||(l[1]=e=>be.quoteForm.drafter=e),disabled:""},null,8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"拟稿人工号:",prop:"drafterNumber"},{default:m((()=>[i(t,{modelValue:be.quoteForm.drafterNumber,"onUpdate:modelValue":l[2]||(l[2]=e=>be.quoteForm.drafterNumber=e),disabled:""},null,8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"拟稿公司:",prop:"draftingCompany"},{default:m((()=>[i(t,{modelValue:be.quoteForm.draftingCompany,"onUpdate:modelValue":l[3]||(l[3]=e=>be.quoteForm.draftingCompany=e),disabled:""},null,8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"拟稿部门:",prop:"draftingDepartment"},{default:m((()=>[i(t,{modelValue:be.quoteForm.draftingDepartment,"onUpdate:modelValue":l[4]||(l[4]=e=>be.quoteForm.draftingDepartment=e),disabled:""},null,8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"拟稿日期:",prop:"draftDate"},{default:m((()=>[i(r,{modelValue:be.quoteForm.draftDate,"onUpdate:modelValue":l[5]||(l[5]=e=>be.quoteForm.draftDate=e),onChange:Pe,disabled:""},null,8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"单据编号:",prop:"number"},{default:m((()=>[i(t,{modelValue:be.quoteForm.number,"onUpdate:modelValue":l[6]||(l[6]=e=>be.quoteForm.number=e),disabled:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),i(n,{class:"demand-apply__card"},{default:m((()=>[i(d,{gutter:20},{default:m((()=>[i(u,{span:8},{default:m((()=>[i(o,{label:"项目名称:",prop:"projectName"},{default:m((()=>[i(t,{modelValue:be.quoteForm.projectName,"onUpdate:modelValue":l[7]||(l[7]=e=>be.quoteForm.projectName=e),placeholder:"与PLM系统保持一致",onChange:Pe},null,8,["modelValue"])])),_:1})])),_:1}),i(u,{span:8},{default:m((()=>[i(o,{label:"项目代码:",prop:"projectCode"},{default:m((()=>[i(t,{modelValue:be.quoteForm.projectCode,"onUpdate:modelValue":l[8]||(l[8]=e=>be.quoteForm.projectCode=e),placeholder:"与PLM系统保持一致"},null,8,["modelValue"])])),_:1})])),_:1}),i(u,{span:8},{default:m((()=>[i(o,{label:"项目版本号:"},{default:m((()=>[i(t,{modelValue:be.quoteVersion,"onUpdate:modelValue":l[9]||(l[9]=e=>be.quoteVersion=e)},null,8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"客户名称:",prop:"customerName"},{default:m((()=>[i(t,{modelValue:be.quoteForm.customerName,"onUpdate:modelValue":l[10]||(l[10]=e=>be.quoteForm.customerName=e),onChange:Pe},null,8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"客户性质:",prop:"customerNature"},{default:m((()=>[i(C,{modelValue:be.quoteForm.customerNature,"onUpdate:modelValue":l[11]||(l[11]=e=>be.quoteForm.customerNature=e),placeholder:"Select"},{default:m((()=>[(c(!0),p(V,null,b(be.customerNatureOptions,(e=>(c(),y(T,{key:e.id,label:e.displayName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"终端名称:",prop:"terminalName"},{default:m((()=>[i(t,{modelValue:be.quoteForm.terminalName,"onUpdate:modelValue":l[12]||(l[12]=e=>be.quoteForm.terminalName=e)},null,8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"终端性质:",prop:"terminalNature"},{default:m((()=>[i(C,{modelValue:be.quoteForm.terminalNature,"onUpdate:modelValue":l[13]||(l[13]=e=>be.quoteForm.terminalNature=e),placeholder:"Select"},{default:m((()=>[(c(!0),p(V,null,b(be.terminalNatureOptions,(e=>(c(),y(T,{key:e.id,label:e.displayName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),i(d,{gutter:20},{default:m((()=>[i(u,{span:6},{default:m((()=>[i(o,{label:"报价形式:",prop:"quotationType"},{default:m((()=>[i(C,{modelValue:be.quoteForm.quotationType,"onUpdate:modelValue":l[14]||(l[14]=e=>be.quoteForm.quotationType=e),placeholder:"Select"},{default:m((()=>[(c(!0),p(V,null,b(be.quotationTypeOptions,(e=>(c(),y(T,{key:e.id,label:e.displayName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"sop时间:",prop:"sopTime"},{default:m((()=>[i(r,{type:"year",placeholder:"Pick a year",modelValue:be.quoteForm.sopTime,"onUpdate:modelValue":l[15]||(l[15]=e=>be.quoteForm.sopTime=e),"value-format":"YYYY"},null,8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"项目周期:",prop:"projectCycle"},{default:m((()=>[i(S,{modelValue:be.quoteForm.projectCycle,"onUpdate:modelValue":l[16]||(l[16]=e=>be.quoteForm.projectCycle=e),onChange:Ne,min:0},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),E,A,g("div",I,[f((c(),y(a,{type:"primary",class:"demand-apply__add-btn",onClick:we},{default:m((()=>[Q])),_:1})),[[ce]])]),i(O,{data:_(Te),border:"","summary-method":M,"show-summary":""},{default:m((()=>[i(N,{label:"车厂",width:"180",fixed:"left"},{default:m((({row:e})=>[i(t,{modelValue:e.carFactory,"onUpdate:modelValue":l=>e.carFactory=l},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),i(N,{label:"车型",width:"180",fixed:"left"},{default:m((({row:e})=>[i(t,{modelValue:e.carModel,"onUpdate:modelValue":l=>e.carModel=l},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(c(!0),p(V,null,b(be.yearCols,((e,l)=>(c(),y(N,{label:e+"",key:e+"",width:"100"},{default:m((({row:e})=>[i(t,{modelValue:e.pcsYearList[l].quantity,"onUpdate:modelValue":a=>e.pcsYearList[l].quantity=a,onChange:l=>(e=>{let l=0;e.pcsYearList.forEach((e=>{l+=Number(e.quantity)})),e.rowSum=l})(e)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:2},1032,["label"])))),128)),i(N,{prop:"rowSum",label:"合计"},{default:m((({row:e})=>[h(q(Ve(e)),1)])),_:1}),i(N,{label:"操作",fixed:"right"},{default:m((({$index:e})=>[f((c(),y(a,{onClick:l=>{return a=e,void Te.value.splice(a,1);var a},type:"danger",disabled:1===_(Te).length},{default:m((()=>[$])),_:2},1032,["onClick","disabled"])),[[ce]])])),_:1})])),_:1},8,["data"]),J,g("div",z,[f((c(),y(a,{type:"primary",class:"demand-apply__add-btn",onClick:Se},{default:m((()=>[B])),_:1})),[[ce]])]),i(O,{data:_(Ce),style:{width:"100%"},border:""},{default:m((()=>[i(N,{type:"index",width:"50"}),i(N,{label:"客户零件号",width:"180"},{default:m((({row:e})=>[i(t,{modelValue:e.partNumber,"onUpdate:modelValue":l=>e.partNumber=l,placeholder:"若没有，填写 /"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),i(N,{label:"产品名称",width:"180"},{default:m((({row:e})=>[i(t,{modelValue:e.product,"onUpdate:modelValue":l=>e.product=l},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),i(N,{label:"产品小类",width:"180"},{default:m((({row:e})=>[i(C,{modelValue:e.productType,"onUpdate:modelValue":l=>e.productType=l,placeholder:"Select"},{default:m((()=>[(c(!0),p(V,null,b(be.productTypeOptions,(e=>(c(),y(T,{key:e.id,label:e.displayName,value:e.id},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),i(N,{label:"市场份额",width:"180"},{default:m((({row:e})=>[i(t,{modelValue:e.marketShare,"onUpdate:modelValue":l=>e.marketShare=l},{append:m((()=>[H])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),i(N,{label:"模组搭载率",width:"180"},{default:m((({row:e})=>[i(t,{modelValue:e.moduleCarryingRate,"onUpdate:modelValue":l=>e.moduleCarryingRate=l},{append:m((()=>[K])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),i(N,{label:"单车产品数量",width:"180"},{default:m((({row:e})=>[i(t,{modelValue:e.singleCarProductsQuantity,"onUpdate:modelValue":l=>e.singleCarProductsQuantity=l},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(c(!0),p(V,null,b(be.yearCols,((e,l)=>(c(),y(N,{label:e+"",key:e+"",width:"180"},{default:m((({row:e})=>[i(t,{modelValue:e.modelCountYearList[l].quantity,"onUpdate:modelValue":a=>e.modelCountYearList[l].quantity=a,onInput:e=>{}},null,8,["modelValue","onUpdate:modelValue","onInput"])])),_:2},1032,["label"])))),128)),i(N,{label:"模组总量",prop:"modelTotal",width:"180"},{default:m((({row:e})=>[i(t,{modelValue:e.modelTotal,"onUpdate:modelValue":l=>e.modelTotal=l},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),i(N,{label:"操作",fixed:"right"},{default:m((({$index:e})=>[f((c(),y(a,{onClick:l=>{return a=e,Ce.value.splice(a,1),void ve.value.splice(a,1);var a},type:"danger",disabled:1===_(Ce).length},{default:m((()=>[W])),_:2},1032,["onClick","disabled"])),[[ce]])])),_:1})])),_:1},8,["data"]),X,i(O,{data:_(Fe),style:{width:"100%",margin:"20px 0"},border:""},{default:m((()=>[i(N,{label:"年份",width:"180",prop:"year"}),i(N,{label:"客户年降率(%)"},{default:m((({row:e})=>[i(t,{modelValue:e.annualDeclineRate,"onUpdate:modelValue":l=>e.annualDeclineRate=l},{append:m((()=>[Z])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),i(N,{label:"年度返利要求(%)"},{default:m((({row:e})=>[i(t,{modelValue:e.annualRebateRequirements,"onUpdate:modelValue":l=>e.annualRebateRequirements=l},{append:m((()=>[G])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),i(N,{label:"一次性折让率(%)"},{default:m((({row:e})=>[i(t,{modelValue:e.oneTimeDiscountRate,"onUpdate:modelValue":l=>e.oneTimeDiscountRate=l},{append:m((()=>[ee])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1},8,["data"]),i(d,{gutter:20},{default:m((()=>[i(u,{span:6},{default:m((()=>[i(o,{label:"模具费分摊:",prop:"allocationOfMouldCost"},{default:m((()=>[i(C,{modelValue:be.quoteForm.allocationOfMouldCost,"onUpdate:modelValue":l[17]||(l[17]=e=>be.quoteForm.allocationOfMouldCost=e),placeholder:"Select"},{default:m((()=>[i(T,{value:!0,label:"是"}),i(T,{value:!1,label:"否"})])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"治具费分摊:",prop:"allocationOfFixtureCost"},{default:m((()=>[i(C,{modelValue:be.quoteForm.allocationOfFixtureCost,"onUpdate:modelValue":l[18]||(l[18]=e=>be.quoteForm.allocationOfFixtureCost=e),placeholder:"Select"},{default:m((()=>[i(T,{value:!0,label:"是"}),i(T,{value:!1,label:"否"})])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"设备费分摊:",prop:"allocationOfEquipmentCost"},{default:m((()=>[i(C,{modelValue:be.quoteForm.allocationOfEquipmentCost,"onUpdate:modelValue":l[19]||(l[19]=e=>be.quoteForm.allocationOfEquipmentCost=e),placeholder:"Select"},{default:m((()=>[i(T,{value:!0,label:"是"}),i(T,{value:!1,label:"否"})])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"信赖性费用分摊:",prop:"reliabilityCost"},{default:m((()=>[i(C,{modelValue:be.quoteForm.reliabilityCost,"onUpdate:modelValue":l[20]||(l[20]=e=>be.quoteForm.reliabilityCost=e),placeholder:"Select"},{default:m((()=>[i(T,{value:!0,label:"是"}),i(T,{value:!1,label:"否"})])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"开发费分摊:",prop:"developmentCost"},{default:m((()=>[i(C,{modelValue:be.quoteForm.developmentCost,"onUpdate:modelValue":l[21]||(l[21]=e=>be.quoteForm.developmentCost=e),placeholder:"Select"},{default:m((()=>[i(T,{value:!0,label:"是"}),i(T,{value:!1,label:"否"})])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"落地工厂:",prop:"landingFactory"},{default:m((()=>[i(C,{modelValue:be.quoteForm.landingFactory,"onUpdate:modelValue":l[22]||(l[22]=e=>be.quoteForm.landingFactory=e),placeholder:"Select"},{default:m((()=>[(c(!0),p(V,null,b(be.landingFactoryOptions,(e=>(c(),y(T,{key:e.id,label:e.displayName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),i(n,{class:"demand-apply__card"},{default:m((()=>[le,i(O,{data:_(ve),style:{width:"100%"},border:""},{default:m((()=>[i(N,{label:"产品名称",width:"180",fixed:"left"},{default:m((({row:e})=>[i(t,{modelValue:e.name,"onUpdate:modelValue":l=>e.name=l,disabled:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),i(N,{label:"目标价",width:"180",fixed:"left"},{default:m((({row:e})=>[i(t,{modelValue:e.customerTargetPrice,"onUpdate:modelValue":l=>e.customerTargetPrice=l},{append:m((()=>[ae])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),i(N,{label:"Sensor",width:"400"},{default:m((({row:e})=>[i(t,{modelValue:e.sensor,"onUpdate:modelValue":l=>e.sensor=l,placeholder:"品牌/型号"},{prepend:m((()=>[i(C,{modelValue:e.sensorTypeSelect,"onUpdate:modelValue":l=>e.sensorTypeSelect=l},{default:m((()=>[i(T,{label:"我司推荐",value:"1"}),i(T,{label:"客户指定",value:"2"}),i(T,{label:"客户供应",value:"3"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),append:m((()=>[i(t,{modelValue:e.sensorPrice,"onUpdate:modelValue":l=>e.sensorPrice=l,placeholder:"单价"},{append:m((()=>[te])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),i(N,{label:"Lens",width:"400"},{default:m((({row:e})=>[i(t,{modelValue:e.lens,"onUpdate:modelValue":l=>e.lens=l,placeholder:"品牌/型号"},{prepend:m((()=>[i(C,{modelValue:e.lensTypeSelect,"onUpdate:modelValue":l=>e.lensTypeSelect=l},{default:m((()=>[i(T,{label:"我司推荐",value:"1"}),i(T,{label:"客户指定",value:"2"}),i(T,{label:"客户供应",value:"3"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),append:m((()=>[i(t,{modelValue:e.lensPrice,"onUpdate:modelValue":l=>e.lensPrice=l,placeholder:"单价"},{append:m((()=>[oe])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),i(N,{label:"ISP",width:"400"},{default:m((({row:e})=>[i(t,{modelValue:e.isp,"onUpdate:modelValue":l=>e.isp=l,placeholder:"品牌/型号"},{prepend:m((()=>[i(C,{modelValue:e.ispTypeSelect,"onUpdate:modelValue":l=>e.ispTypeSelect=l},{default:m((()=>[i(T,{label:"我司推荐",value:"1"}),i(T,{label:"客户指定",value:"2"}),i(T,{label:"客户供应",value:"3"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),append:m((()=>[i(t,{modelValue:e.ispPrice,"onUpdate:modelValue":l=>e.ispPrice=l,placeholder:"单价"},{append:m((()=>[ue])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),i(N,{label:"串行芯片",width:"400"},{default:m((({row:e})=>[i(t,{modelValue:e.serialChip,"onUpdate:modelValue":l=>e.serialChip=l,placeholder:"品牌/型号"},{prepend:m((()=>[i(C,{modelValue:e.serialChipTypeSelect,"onUpdate:modelValue":l=>e.serialChipTypeSelect=l},{default:m((()=>[i(T,{label:"我司推荐",value:"1"}),i(T,{label:"客户指定",value:"2"}),i(T,{label:"客户供应",value:"3"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),append:m((()=>[i(t,{modelValue:e.serialChipPrice,"onUpdate:modelValue":l=>e.serialChipPrice=l,placeholder:"单价"},{append:m((()=>[re])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),i(N,{label:"线缆",width:"400"},{default:m((({row:e})=>[i(t,{modelValue:e.cable,"onUpdate:modelValue":l=>e.cable=l,placeholder:"品牌/型号"},{prepend:m((()=>[i(C,{modelValue:e.cableTypeSelect,"onUpdate:modelValue":l=>e.cableTypeSelect=l},{default:m((()=>[i(T,{label:"我司推荐",value:"1"}),i(T,{label:"客户指定",value:"2"}),i(T,{label:"客户供应",value:"3"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),append:m((()=>[i(t,{modelValue:e.cablePrice,"onUpdate:modelValue":l=>e.cablePrice=l,placeholder:"单价"},{append:m((()=>[de])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),i(N,{label:"LED",width:"400"},{default:m((({row:e})=>[i(t,{modelValue:e.led,"onUpdate:modelValue":l=>e.led=l,placeholder:"品牌/型号"},{prepend:m((()=>[i(C,{modelValue:e.ledTypeSelect,"onUpdate:modelValue":l=>e.ledTypeSelect=l},{default:m((()=>[i(T,{label:"我司推荐",value:"1"}),i(T,{label:"客户指定",value:"2"}),i(T,{label:"客户供应",value:"3"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),append:m((()=>[i(t,{modelValue:e.ledPrice,"onUpdate:modelValue":l=>e.ledPrice=l,placeholder:"单价"},{append:m((()=>[ne])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),i(N,{label:"制程",width:"180"},{default:m((({row:e})=>[i(t,{modelValue:e.manufactureProcess,"onUpdate:modelValue":l=>e.manufactureProcess=l},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),i(N,{label:"安装位置",width:"180"},{default:m((({row:e})=>[i(t,{modelValue:e.installationPosition,"onUpdate:modelValue":l=>e.installationPosition=l},null,8,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1},8,["data"]),pe,i(a,{onClick:ke,type:"primary",style:{margin:"20px 0"}},{default:m((()=>[ie])),_:1}),i(O,{data:_(Ue),style:{width:"100%"},border:""},{default:m((()=>[i(N,{prop:"productType",label:"类型"}),i(N,{prop:"productName",label:"产品名称"}),i(N,{prop:"main",label:"核心部件"}),i(N,{prop:"type",label:"品牌/型号"}),i(N,{prop:"price",label:"单价"})])),_:1},8,["data"])])),_:1}),i(n,{class:"demand-apply__card"},{default:m((()=>[i(d,{gutter:20},{default:m((()=>[i(u,{span:6},{default:m((()=>[i(o,{label:"贸易方式:",prop:"tradeMode"},{default:m((()=>[i(C,{modelValue:be.quoteForm.tradeMode,"onUpdate:modelValue":l[23]||(l[23]=e=>be.quoteForm.tradeMode=e),placeholder:"Select"},{default:m((()=>[(c(!0),p(V,null,b(be.TradeMethodOptions,(e=>(c(),y(T,{key:e.id,label:e.displayName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"销售类型:",prop:"salesType"},{default:m((()=>[i(C,{modelValue:be.quoteForm.salesType,"onUpdate:modelValue":l[24]||(l[24]=e=>be.quoteForm.salesType=e),placeholder:"Select"},{default:m((()=>[(c(!0),p(V,null,b(be.salesTypeOptions,(e=>(c(),y(T,{key:e.id,label:e.displayName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"付款方式:",prop:"paymentMethod"},{default:m((()=>[i(t,{modelValue:be.quoteForm.paymentMethod,"onUpdate:modelValue":l[25]||(l[25]=e=>be.quoteForm.paymentMethod=e)},null,8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"报价币种:",prop:"currency"},{default:m((()=>[i(C,{modelValue:be.quoteForm.currency,"onUpdate:modelValue":l[26]||(l[26]=e=>be.quoteForm.currency=e),placeholder:"Select",onChange:je},{default:m((()=>[(c(!0),p(V,null,b(be.ExchangeSelectOptions,(e=>(c(),y(T,{key:e.id,label:e.exchangeRateKind,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"客户目标价（整套）:",prop:"customerTargetPrice"},{default:m((()=>[i(t,{modelValue:be.quoteForm.customerTargetPrice,"onUpdate:modelValue":l[27]||(l[27]=e=>be.quoteForm.customerTargetPrice=e)},null,8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"汇率:",prop:"exchangeRate"},{default:m((()=>[i(t,{modelValue:be.quoteForm.exchangeRate,"onUpdate:modelValue":l[28]||(l[28]=e=>be.quoteForm.exchangeRate=e),disabled:""},null,8,["modelValue"])])),_:1})])),_:1}),i(u,{span:12},{default:m((()=>[i(o,{label:"客户特殊性要求:",prop:"customerSpecialRequest"},{default:m((()=>[i(t,{type:"textarea",rows:10,modelValue:be.quoteForm.customerSpecialRequest,"onUpdate:modelValue":l[29]||(l[29]=e=>be.quoteForm.customerSpecialRequest=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),i(n,{class:"demand-apply__card"},{default:m((()=>[i(d,{gutter:20},{default:m((()=>[i(u,{span:6},{default:m((()=>[i(o,{label:"运输方式:",prop:"shippingType"},{default:m((()=>[i(C,{modelValue:be.quoteForm.shippingType,"onUpdate:modelValue":l[30]||(l[30]=e=>be.quoteForm.shippingType=e),placeholder:"Select"},{default:m((()=>[(c(!0),p(V,null,b(be.shippingTypeOptions,(e=>(c(),y(T,{key:e.id,label:e.displayName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"包装方式:",prop:"packagingType"},{default:m((()=>[i(C,{modelValue:be.quoteForm.packagingType,"onUpdate:modelValue":l[31]||(l[31]=e=>be.quoteForm.packagingType=e),placeholder:"Select"},{default:m((()=>[(c(!0),p(V,null,b(be.packagingTypeOptions,(e=>(c(),y(T,{key:e.id,label:e.displayName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"核价要求完成时间:",prop:"deadline"},{default:m((()=>[i(r,{type:"date",placeholder:"Pick a day",modelValue:be.quoteForm.deadline,"onUpdate:modelValue":l[32]||(l[32]=e=>be.quoteForm.deadline=e)},null,8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"项目经理:",prop:"projectManager"},{default:m((()=>[i(_(k),{modelValue:be.quoteForm.projectManager,"onUpdate:modelValue":l[33]||(l[33]=e=>be.quoteForm.projectManager=e),roleName:"项目经理"},null,8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,{label:"出口国家:",prop:"country"},{default:m((()=>[i(C,{modelValue:be.quoteForm.country,"onUpdate:modelValue":l[34]||(l[34]=e=>be.quoteForm.country=e),placeholder:"Select"},{default:m((()=>[(c(!0),p(V,null,b(be.countryOptions,(e=>(c(),y(T,{key:e.id,label:e.displayName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(u,{span:8},{default:m((()=>[i(o,{label:"交货地点:",prop:"placeOfDelivery"},{default:m((()=>[i(t,{type:"textarea",rows:10,modelValue:be.quoteForm.placeOfDelivery,"onUpdate:modelValue":l[35]||(l[35]=e=>be.quoteForm.placeOfDelivery=e)},null,8,["modelValue"])])),_:1})])),_:1}),i(u,{span:8},{default:m((()=>[i(o,{label:"核价原因:",prop:"reason"},{default:m((()=>[i(t,{type:"textarea",rows:10,modelValue:be.quoteForm.reason,"onUpdate:modelValue":l[36]||(l[36]=e=>be.quoteForm.reason=e)},null,8,["modelValue"])])),_:1})])),_:1}),i(u,{span:6},{default:m((()=>[i(o,null,{default:m((()=>[i(P,{"file-list":ge.value,"onUpdate:file-list":l[37]||(l[37]=e=>ge.value=e),action:"/api/services/app/FileCommonService/UploadFile","on-success":Oe,"on-error":_(j),"on-change":De,multiple:"","on-progress":_(x)},{default:m((()=>[i(a,null,{default:m((()=>[me])),_:1})])),_:1},8,["file-list","on-error","on-progress"])])),_:1})])),_:1})])),_:1}),f((c(),y(a,{type:"primary",size:"large",style:{float:"right",margin:"20px 0"},onClick:l[38]||(l[38]=e=>(async e=>{let{auditFlowId:l}=he.query;e&&await e.validate((async(e,a)=>{if(e){let{quoteForm:e}=be;e.auditFlowId=l?Number(l):5,e.pcs=Te,e.modelCount=Ce,e.requirement=Fe,e.productInformation=ve,e.sorFile=ge.value.map((e=>e.response.result.fileId)),(await D(e)).success&&(F({type:"success",message:"保存成功"}),qe.push({path:"/todoCenter/index"}))}else be.quoteForm}))})(U.value))},{default:m((()=>[se])),_:1})),[[ce]])])),_:1})])),_:1},8,["model","rules"])])}}}),[["__scopeId","data-v-7d829631"]]);export{ce as default};
