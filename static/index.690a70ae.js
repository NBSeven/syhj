import{Q as a,_ as e,a as t,M as l,k as o,m as r,N as i,S as p,I as s,f as n,w as u,r as d,X as c,o as b,e as m,i as f,b as h,n as C,F as w,y,t as g,$ as v,a0 as _,z as D,A as I}from"./index.c6c04119.js";import{g as x}from"./getQuery.b59b1282.js";import{E as P}from"./index.dc1645fa.js";import{g as T}from"./service.a3ac1097.js";const E=a=>(D("data-v-490594e4"),a=a(),I(),a),N=y(" 是否为全生命周期： "),q=y(" 产品核价表下载 "),A=E((()=>f("div",{class:"card-header"},[f("span",null,"项目核价表（量产/样品）")],-1)));var k=e(t({__name:"index",setup(e){const{auditFlowId:t,productId:D,disabled:I}=x(),E=l(!1),k=o({material:[],manufacturingCost:[],lossCost:[],otherCostItem:[],isAll:!1,date:"",inputCount:"",requiredCount:"",year:"",filterNnum:[{label:"年份",key:"year",role:"select",options:[],onchange:a=>k.year=a},{label:"投入量",key:"inputCount"}],pageType:"normal",preparedDate:"",auditDate:"",approvalDate:"",disabled:!1}),F=[{label:"是",value:!0},{label:"否",value:!1}],M=async()=>{const{result:e}=await function(e){return a({url:"/api/services/app/PriceEvaluation/GetPriceEvaluationTableResult",method:"get",data:e})}({auditFlowId:t,modelCountId:D,isAll:String(!!k.isAll)});V(e)},V=a=>{let{material:e,manufacturingCost:t,lossCost:l,otherCostItem:o}=a||{};k.material=e||[],k.manufacturingCost=t||[],k.lossCost=l||[],k.otherCostItem=[o],k.preparedDate=v(a.preparedDate),k.auditDate=v(a.auditDate),k.approvalDate=v(a.approvalDate)},j=async e=>{const{inputCount:l,year:o}=e;k.inputCount=l,k.year=o;let{result:r}=await function(e){return a({url:"/api/services/app/PriceEvaluation/GetPriceEvaluationTable",method:"get",data:e})}({auditFlowId:t,modelCountId:D,inputCount:l,year:o})||{};V(r)},Q=async()=>{try{const e=await function(e){return a({url:"/api/services/app/PriceEvaluation/PriceEvaluationTableDownload",method:"get",data:e,responseType:"blob"})}({AuditFlowId:t,ModelCountId:D});_(e,"产品核价表")}catch(e){}};r((()=>{})),i((async()=>{(async()=>{const{result:a}=await T(t)||{};k.filterNnum[0].options=a.map((a=>({label:a})))||[]})(),k.disabled=I}));const S=async a=>{try{if(E.value=!0,k.material=[],k.manufacturingCost=[],k.lossCost=[],"result"===a)await M();else{const{inputCount:a,year:e}=k;await j({inputCount:a,year:e})}E.value=!1}catch{E.value=!1}};return p((()=>{})),(a,e)=>{const t=d("el-tab-pane"),l=d("el-option"),o=d("el-select"),r=d("el-button"),i=d("el-row"),p=d("el-tabs"),v=d("el-table-column"),_=d("el-table"),D=d("el-card"),I=d("el-descriptions-item"),x=d("el-descriptions"),T=c("loading");return s((b(),n(D,{m:"2"},{default:u((()=>[m(p,{modelValue:k.pageType,"onUpdate:modelValue":e[1]||(e[1]=a=>k.pageType=a),class:"demo-tabs",onTabChange:S},{default:u((()=>[m(t,{label:"项目核价表",name:"normal"},{default:u((()=>[m(P,{filterNnum:k.filterNnum,"show-btn":!0,onSubmit:j},null,8,["filterNnum"])])),_:1}),m(t,{label:"生成的项目核价表",name:"result",disabled:k.disabled},{default:u((()=>[m(i,{justify:"space-between"},{default:u((()=>[f("div",null,[N,m(o,{placeholder:"请选择",modelValue:k.isAll,"onUpdate:modelValue":e[0]||(e[0]=a=>k.isAll=a),onChange:M},{default:u((()=>[(b(),h(w,null,C(F,(a=>m(l,{key:a.label,label:a.label,value:a.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])]),m(r,{type:"primary",class:"m-2",onClick:Q},{default:u((()=>[q])),_:1})])),_:1})])),_:1},8,["disabled"])])),_:1},8,["modelValue"]),m(D,{class:"card"},{header:u((()=>[A])),default:u((()=>[m(_,{data:k.material,border:""},{default:u((()=>[m(v,{type:"index",width:"50"}),m(v,{label:"超级大种类",prop:"superType",width:"180"}),m(v,{label:"超级大类",prop:"categoryName",width:"180"}),m(v,{label:"sap",prop:"sap",width:"180"}),m(v,{label:"材料名称",prop:"materialName",width:"180"}),m(v,{label:"装配数量",prop:"assemblyCount",width:"180"}),m(v,{label:"材料单价（原币）",prop:"materialPrice",width:"180"}),m(v,{label:"币别",prop:"currencyText",width:"180"}),m(v,{label:"汇率",prop:"exchangeRate",width:"180"}),m(v,{label:"材料单价（人民币）",prop:"materialPriceCyn",width:"180"}),m(v,{label:"合计金额（人民币）",prop:"totalMoneyCyn",width:"180"}),m(v,{label:"损耗",prop:"loss",width:"180"}),m(v,{label:"材料成本（含损耗）",prop:"materialCost",width:"180"}),m(v,{label:"投入量",prop:"inputCount",width:"180"}),m(v,{label:"采购量",prop:"purchaseCount",width:"180"}),m(v,{label:"MOQ分摊成本",prop:"moqShareCount",width:"180"}),m(v,{label:"MOQ",prop:"moq",width:"180"}),m(v,{label:"可用库存",prop:"availableInventory",width:"180"}),m(v,{label:"备注",prop:"remarks",width:"180"})])),_:1},8,["data"])])),_:1}),m(D,{class:"card"},{default:u((()=>[m(_,{data:k.manufacturingCost,style:{width:"100%"},border:""},{default:u((()=>[m(v,{label:"成本项目",prop:"costItem",width:"180"}),m(v,{label:"直接制造成本",prop:""},{default:u((()=>[m(v,{label:"直接人工",prop:"manufacturingCostDirect.directLabor"}),m(v,{label:"设备折旧",prop:"manufacturingCostDirect.equipmentDepreciation"}),m(v,{label:"换线成本",prop:"manufacturingCostDirect.lineChangeCost"}),m(v,{label:"制造费用",prop:"manufacturingCostDirect.manufacturingExpenses"}),m(v,{label:"小计",prop:"manufacturingCostDirect.subtotal"})])),_:1}),m(v,{label:"间接制造成本",prop:""},{default:u((()=>[m(v,{label:"直接人工",prop:"manufacturingCostIndirect.directLabor"}),m(v,{label:"设备折旧",prop:"manufacturingCostIndirect.equipmentDepreciation"}),m(v,{label:"制造费用",prop:"manufacturingCostIndirect.manufacturingExpenses"}),m(v,{label:"小计",prop:"manufacturingCostIndirect.subtotal"})])),_:1}),m(v,{label:"合计",prop:"subtotal"})])),_:1},8,["data"])])),_:1}),m(D,{class:"card"},{default:u((()=>[m(_,{data:k.lossCost,border:""},{default:u((()=>[m(v,{label:"成本项目",prop:"name"}),m(v,{label:"损耗成本",prop:"wastageCost"}),m(v,{label:"MOQ分摊成本",prop:"moqShareCount"})])),_:1},8,["data"])])),_:1}),m(D,{class:"card"},{default:u((()=>[m(_,{data:k.otherCostItem,border:""},{default:u((()=>[m(v,{label:"夹具",prop:"fixture",width:"180"}),m(v,{label:"物流费",prop:"logisticsFee",width:"180"}),m(v,{label:"质量成本",prop:"",width:"180"},{default:u((()=>[m(v,{label:"产品类别",prop:"productCategory",width:"180"}),m(v,{label:"成本比例",prop:"costProportion",width:"180"}),m(v,{label:"质量成本",prop:"qualityCost",width:"180"})])),_:1}),m(v,{label:"财务成本",prop:"financialCost",width:"180"}),m(v,{label:"账期",prop:"accountingPeriod",width:"180"}),m(v,{label:"资金成本率",prop:"capitalCostRate",width:"180"}),m(v,{label:"财务成本",prop:"financialCost",width:"180"}),m(v,{label:"税务成本",prop:"taxCost",width:"180"}),m(v,{label:"合计",prop:"total",width:"180"})])),_:1},8,["data"])])),_:1}),m(x,{column:3,border:""},{default:u((()=>[m(I,{label:"编制/日期："},{default:u((()=>[y(g(k.preparedDate),1)])),_:1}),m(I,{label:"审核/日期："},{default:u((()=>[y(g(k.auditDate),1)])),_:1}),m(I,{label:"批准/日期："},{default:u((()=>[y(g(k.approvalDate),1)])),_:1})])),_:1})])),_:1})),[[T,E.value]])}}}),[["__scopeId","data-v-490594e4"]]);export{k as default};
