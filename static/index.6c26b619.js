import{a as e,b as a,c as l,d as o,s as t}from"./service.29e1e783.js";import{g as d}from"./getQuery.cd413be6.js";import{C as i}from"./bom.8dbb0ccc.js";import{_ as r,a as s,k as n,m as u,N as m,l as g,S as c,W as p,b,i as V,e as h,w as F,r as f,o as P,I as _,f as y,y as k,E as w,X as x,z as I,A as U}from"./index.5e590414.js";const L=e=>(I("data-v-85fcadbe"),e=e(),U(),e),C={class:"pm-department"},E={class:"pm-department__btn-container"},v=k("SOR查看"),D=k("查看物流&包装基础数据"),W={style:{float:"right",margin:"20px 0"}},H=k("提交"),N=L((()=>V("h5",null,"物流基础信息",-1))),B=L((()=>V("h6",null,"外包装体积",-1))),S=k("cm"),j=k("cm"),R=k("cm"),q=L((()=>V("h6",null,"重量",-1))),Q=k("kg"),T=k("pcs"),A=L((()=>V("h5",null,"包装基础信息",-1))),O=L((()=>V("h6",null,"内包装体积",-1))),Y=k("mm"),z=k("mm"),X=k("mm"),G=k(" 箱/托"),J=k(" PCS/箱");var K=r(s({__name:"index",setup(r,{expose:s}){const k=n({tableData:[],auditFlowId:0,productId:0,dialogFormVisible:!1,logisticsForm:{outerPackagingLength:"",outerPackagingWidth:"",outerPackagingHeight:"",singleProductWeight:"",singleBoxQuantity:"",innerPackagingLength:"",innerPackagingWidth:"",innerPackagingHeight:"",isHit:"",boxesPerPallet:"",quantityPerBox:"",remarks:"",pictureId:""}});u((()=>{})),m((async()=>{var o;let t=d();k.auditFlowId=Number(t.auditFlowId)||1,k.productId=Number(t.productId)||1;let i=await e(k.auditFlowId,k.productId);if(i.result.infoList.length>0)k.tableData=i.result.infoList;else{let{result:e}=await a(k.auditFlowId),l=[],t=[];e.items.forEach((e=>{e.modelCountYearListDto.forEach(((e,a)=>{l[a]||(l[a]=[]),l[a].push(e.quantity)}))})),null==(o=e.items[0])||o.modelCountYearListDto.forEach((e=>{t.push(e.year)}));let d=[];l.forEach(((e,a)=>{d[a]=e.reduce(((e,a)=>e+a))})),(null==t?void 0:t.length)>0&&(k.tableData=t.map(((e,a)=>({year:e,perPackagingPrice:"",freight:"",storageExpenses:"",monthEndDemand:(d[a]/12).toFixed(0),perFreight:"",perTotalLogisticsCost:""})))),g(k.tableData,(e=>{e.forEach((e=>{e.perFreight=((Number(e.freight)+Number(e.storageExpenses))/e.monthEndDemand).toFixed(2),e.perTotalLogisticsCost=(Number(e.perPackagingPrice)+Number(e.perFreight)).toFixed(2)}))}),{deep:!0})}let r=await l({auditFlowId:k.auditFlowId,productId:k.productId});k.logisticsForm=r.result})),c((()=>{}));const I=async()=>{const{result:e}=await o(k.auditFlowId)||{};const a=await i(e.sorFileId),l=new FileReader;l.readAsDataURL(a),l.onload=function(){let l=URL.createObjectURL(new Blob([a])),o=document.createElement("a");document.body.appendChild(o),o.href=l,o.download=e.sorFileName,o.target="_blank",o.click(),o.remove()}},U=async()=>{let{auditFlowId:e,productId:a}=k,l=k.tableData.map((e=>e));(await t({auditFlowId:e,productId:a,infoList:l})).success&&w.success("提交成功")};return s({...p(k)}),(e,a)=>{const l=f("el-button"),o=f("el-table-column"),t=f("el-input"),d=f("el-table"),i=f("el-card"),r=f("el-form-item"),s=f("el-option"),n=f("el-select"),u=f("el-form"),m=f("el-dialog"),g=x("havedone");return P(),b("div",C,[V("div",E,[h(l,{type:"primary",onClick:I},{default:F((()=>[v])),_:1}),h(l,{type:"primary",onClick:a[0]||(a[0]=e=>k.dialogFormVisible=!0)},{default:F((()=>[D])),_:1})]),h(i,null,{default:F((()=>[h(d,{data:k.tableData,style:{width:"100%"},border:""},{default:F((()=>[h(o,{label:"年份",prop:"year"}),h(o,{label:"单PCS包装价格/元"},{default:F((({row:e})=>[h(t,{modelValue:e.perPackagingPrice,"onUpdate:modelValue":a=>e.perPackagingPrice=a},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),h(o,{label:"运费/月"},{default:F((({row:e})=>[h(t,{modelValue:e.freight,"onUpdate:modelValue":a=>e.freight=a},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),h(o,{label:"仓储费用/月"},{default:F((({row:e})=>[h(t,{modelValue:e.storageExpenses,"onUpdate:modelValue":a=>e.storageExpenses=a},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),h(o,{label:"月度需求量",prop:"monthEndDemand"}),h(o,{label:"单PCS运输费",prop:"perFreight"}),h(o,{label:"单PCS总物流成本",prop:"perTotalLogisticsCost"})])),_:1},8,["data"]),V("div",W,[_((P(),y(l,{onClick:U,type:"primary"},{default:F((()=>[H])),_:1})),[[g]])])])),_:1}),h(m,{modelValue:k.dialogFormVisible,"onUpdate:modelValue":a[13]||(a[13]=e=>k.dialogFormVisible=e),title:"物流基础信息"},{default:F((()=>[h(u,{model:k.logisticsForm,inline:""},{default:F((()=>[N,B,h(r,{label:"外包装长"},{default:F((()=>[h(t,{modelValue:k.logisticsForm.outerPackagingLength,"onUpdate:modelValue":a[1]||(a[1]=e=>k.logisticsForm.outerPackagingLength=e),readonly:""},{append:F((()=>[S])),_:1},8,["modelValue"])])),_:1}),h(r,{label:"外包装宽"},{default:F((()=>[h(t,{modelValue:k.logisticsForm.outerPackagingWidth,"onUpdate:modelValue":a[2]||(a[2]=e=>k.logisticsForm.outerPackagingWidth=e),readonly:""},{append:F((()=>[j])),_:1},8,["modelValue"])])),_:1}),h(r,{label:"外包装高"},{default:F((()=>[h(t,{modelValue:k.logisticsForm.outerPackagingHeight,"onUpdate:modelValue":a[3]||(a[3]=e=>k.logisticsForm.outerPackagingHeight=e),readonly:""},{append:F((()=>[R])),_:1},8,["modelValue"])])),_:1}),q,h(r,{label:"单个产品重量"},{default:F((()=>[h(t,{modelValue:k.logisticsForm.singleProductWeight,"onUpdate:modelValue":a[4]||(a[4]=e=>k.logisticsForm.singleProductWeight=e),readonly:""},{append:F((()=>[Q])),_:1},8,["modelValue"])])),_:1}),h(r,{label:"单箱数量"},{default:F((()=>[h(t,{modelValue:k.logisticsForm.singleBoxQuantity,"onUpdate:modelValue":a[5]||(a[5]=e=>k.logisticsForm.singleBoxQuantity=e),readonly:""},{append:F((()=>[T])),_:1},8,["modelValue"])])),_:1}),A,O,h(r,{label:"内包装长"},{default:F((()=>[h(t,{modelValue:k.logisticsForm.innerPackagingLength,"onUpdate:modelValue":a[6]||(a[6]=e=>k.logisticsForm.innerPackagingLength=e),readonly:""},{append:F((()=>[Y])),_:1},8,["modelValue"])])),_:1}),h(r,{label:"内包装宽"},{default:F((()=>[h(t,{modelValue:k.logisticsForm.innerPackagingWidth,"onUpdate:modelValue":a[7]||(a[7]=e=>k.logisticsForm.innerPackagingWidth=e),readonly:""},{append:F((()=>[z])),_:1},8,["modelValue"])])),_:1}),h(r,{label:"内包装高"},{default:F((()=>[h(t,{modelValue:k.logisticsForm.innerPackagingHeight,"onUpdate:modelValue":a[8]||(a[8]=e=>k.logisticsForm.innerPackagingHeight=e),readonly:""},{append:F((()=>[X])),_:1},8,["modelValue"])])),_:1}),h(r,{label:"是否打托"},{default:F((()=>[h(n,{modelValue:k.logisticsForm.isHit,"onUpdate:modelValue":a[9]||(a[9]=e=>k.logisticsForm.isHit=e),placeholder:"Select",disabled:""},{default:F((()=>[h(s,{label:"是",value:"1"}),h(s,{label:"否",value:"0"})])),_:1},8,["modelValue"])])),_:1}),h(r,{label:"每托盘箱数"},{default:F((()=>[h(t,{modelValue:k.logisticsForm.boxesPerPallet,"onUpdate:modelValue":a[10]||(a[10]=e=>k.logisticsForm.boxesPerPallet=e),readonly:""},{append:F((()=>[G])),_:1},8,["modelValue"])])),_:1}),h(r,{label:"单箱包装数量"},{default:F((()=>[h(t,{modelValue:k.logisticsForm.quantityPerBox,"onUpdate:modelValue":a[11]||(a[11]=e=>k.logisticsForm.quantityPerBox=e),readonly:""},{append:F((()=>[J])),_:1},8,["modelValue"])])),_:1}),h(r,{label:"备注"},{default:F((()=>[h(t,{modelValue:k.logisticsForm.remarks,"onUpdate:modelValue":a[12]||(a[12]=e=>k.logisticsForm.remarks=e),type:"textarea",readonly:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-85fcadbe"]]);export{K as default};
