import{a as e,S as a}from"./service.134be5e1.js";import{g as l}from"./service.381f0b08.js";import{g as t}from"./service.faa07dc3.js";import{g as r}from"./getQuery.d371256b.js";import{u as o}from"./useJump.aecaae5d.js";import{_ as n,a as d,M as s,k as u,m as i,N as p,S as c,f as m,w as y,r as b,o as w,b as v,n as h,I as f,e as g,F as _,x as k,y as C,t as N,Z as I,X as x}from"./index.ca893667.js";const M=C("同意"),j=C("拒绝");var T=n(d({__name:"construction",setup(n){const{jumpTodoCenter:d}=o(),{auditFlowId:T=1,productId:$=1}=r(),F=s([]),S=s(!1),V=u({sop:[]}),R=u({auditFlowId:T,productId:$}),A=s([]);i((()=>{B(),U()})),p((()=>{F.value,D()}));const B=async()=>{const e=await l({maxResultCount:100,skipCount:0});A.value=e.result.items||[]},D=async()=>{try{S.value=!0;const{result:a}=await e(T,$);F.value=a,S.value=!1}catch{S.value=!1}},P=e=>{let l=e?"您确定要同意嘛？":"请输入拒绝理由";I[e?"confirm":"prompt"](l,"请审核",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async l=>{const{success:t}=await a({isAgree:e,auditFlowId:T,bomCheckType:4,opinionDescription:e?"":l.value});t&&d()}))},U=async()=>{const{result:e}=await t(T)||{};V.sop=e||[]};return c((()=>{})),(e,a)=>{const l=b("el-table-column"),t=b("el-option"),r=b("el-select"),o=b("el-table"),n=b("el-card"),d=b("el-button"),s=b("el-row"),u=x("loading"),i=x("havedone");return w(),m(n,{class:"wrap m-2",header:"结构bom单价审核"},{default:y((()=>[(w(!0),v(_,null,h(F.value,(e=>(w(),m(n,{header:e.superTypeName,key:e.superTypeName,class:"table-wrap"},{default:y((()=>[f((w(),m(o,{data:e.structureMaterial,style:{width:"100%"},height:"75vh"},{default:y((()=>[g(l,{label:"bom",align:"center"},{default:y((()=>[g(l,{type:"index",label:"序号",width:"70"}),g(l,{prop:"categoryName",label:"物料大类",width:"150"}),g(l,{prop:"typeName",label:"物料种类",width:"150"}),g(l,{prop:"sapItemNum",label:"物料编号",width:"150"}),g(l,{prop:"drawingNumName",label:"图号名称",width:"150"}),g(l,{prop:"overallDimensionSize",label:"外形尺寸",width:"150"}),g(l,{prop:"materialName",label:"材料",width:"150"}),g(l,{prop:"weightNumber",label:"重量g",width:"150"}),g(l,{prop:"moldingProcess",label:"成型工艺",width:"150"}),g(l,{prop:"secondaryProcessingMethod",label:"二次加工方法",width:"150"}),g(l,{prop:"surfaceTreatmentMethod",label:"表面处理",width:"150"}),g(l,{prop:"dimensionalAccuracyRemark",label:"关键尺寸精度及重要要求",width:"150"}),g(l,{prop:"currency",label:"币种",width:"150"},{default:y((e=>[e.row.isEdit?(w(),m(r,{key:0,modelValue:e.row.currency,"onUpdate:modelValue":a=>e.row.currency=a,placeholder:"选择币种"},{default:y((()=>[(w(!0),v(_,null,h(A.value,(e=>(w(),m(t,{key:e.id,label:e.exchangeRateKind,value:e.id},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])):k("",!0)])),_:2},1024)])),_:2},1024),g(l,{prop:"iginalCurrency",label:"原币"},{default:y((()=>[(w(!0),v(_,null,h(null==V?void 0:V.sop,((e,a)=>(w(),m(l,{key:`construction-iginalCurrency${e}`,label:`${null==e?void 0:e.toString()}`,prop:`iginalCurrency[${a}].value`,width:"180"},{default:y((({row:e})=>{var l;return[C(N((null==e?void 0:e.iginalCurrency)&&(null==(l=null==e?void 0:e.iginalCurrency[a])?void 0:l.value)||0),1)]})),_:2},1032,["label","prop"])))),128))])),_:2},1024),g(l,{prop:"standardMoney",label:"本位币"},{default:y((()=>[(w(!0),v(_,null,h(null==V?void 0:V.sop,((e,a)=>(w(),m(l,{key:`construction-standardMoney${e}`,label:`${null==e?void 0:e.toString()}`,prop:`standardMoney[${a}].value`,width:"180"},{default:y((({row:e})=>{var l;return[C(N(e.standardMoney&&(null==(l=e.standardMoney[a])?void 0:l.value)||0),1)]})),_:2},1032,["label","prop"])))),128))])),_:2},1024),g(l,{prop:"remark",label:"备注"}),g(l,{prop:"peopleName",label:"确认人"})])),_:2},1032,["data"])),[[u,S.value]])])),_:2},1032,["header"])))),128)),R.auditFlowId&&R.productId?(w(),m(s,{key:0,justify:"end",style:{"margin-top":"20px"}},{default:y((()=>[f((w(),m(d,{type:"primary",onClick:a[0]||(a[0]=e=>P(!0))},{default:y((()=>[M])),_:1})),[[i]]),f((w(),m(d,{type:"danger",onClick:a[1]||(a[1]=e=>P(!1))},{default:y((()=>[j])),_:1})),[[i]])])),_:1})):k("",!0)])),_:1})}}}),[["__scopeId","data-v-72242c9a"]]);export{T as default};
