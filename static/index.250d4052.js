import{G as e,S as a,D as l}from"./bom.8dbb0ccc.js";import{g as t}from"./getQuery.cd413be6.js";import{_ as o}from"./index.faa7ae94.js";import{h as s,a as r}from"./upload.4d24e1ae.js";import{_ as d,a as i,k as n,N as u,b as c,e as m,i as p,w as b,E as f,r as w,o as _,g as y,z as h,A as g,y as v}from"./index.5e590414.js";import"./service.9d0c8038.js";const I=e=>(h("data-v-4fa595ae"),e=e(),g(),e),V={class:"electronic-import"},D={class:"electronic-import__btn-container"},x=v("电子料上传"),F=v("电子料模版下载"),N=I((()=>p("h5",null,"电子料导入",-1))),S={style:{float:"right","margin-top":"20px"}},j=v("提交"),k={class:"dialog-footer"},U=v("取消"),C=v("保存");var B=d(i({__name:"index",setup(d){let i=null,h=null;const g=n({activeIndex:0,productList:[],tableData:[],setVisible:!1,downloadSetForm:{number:0}}),v=e=>{e.success&&(!1===e.result.isSuccess?f({message:e.result.message,type:"error"}):g.tableData=e.result.electronicBomDtos)},I=async()=>{const e=await l(Number(g.downloadSetForm.number)),a=new FileReader;a.readAsDataURL(e),a.onload=function(){let a=URL.createObjectURL(new Blob([e])),l=document.createElement("a");document.body.appendChild(l),l.href=a,l.download="模板文件.xlsx",l.target="_blank",l.click(),l.remove()},g.setVisible=!1},B=async()=>{let{success:e}=await a({auditFlowId:i,productId:h,electronicBomDtos:g.tableData});e&&f.success("提交成功！")};return u((async()=>{let a=t();if(i=Number(a.auditFlowId)||null,h=Number(a.productId)||null,i&&h){let a=await e({auditFlowId:i,productId:h});g.tableData=a.result}})),(e,a)=>{const l=w("el-button"),t=w("el-upload"),d=w("el-form-item"),i=w("el-form"),n=w("el-table-column"),u=w("el-table"),f=w("el-input"),h=w("el-dialog");return _(),c("div",V,[m(o),p("div",D,[m(i,{inline:!0},{default:b((()=>[m(d,{label:""},{default:b((()=>[m(t,{action:"/api/services/app/ElectronicBom/UploadExcel","on-success":v,"on-error":y(s),"show-file-list":!1,"on-progress":y(r)},{default:b((()=>[m(l,{type:"primary"},{default:b((()=>[x])),_:1})])),_:1},8,["on-error","on-progress"])])),_:1}),m(d,{label:""},{default:b((()=>[m(l,{type:"primary",onClick:a[0]||(a[0]=e=>g.setVisible=!0)},{default:b((()=>[F])),_:1})])),_:1})])),_:1})]),N,m(u,{data:g.tableData,border:"",style:{width:"100%"},height:"700"},{default:b((()=>[m(n,{prop:"categoryName",label:"物料大类",width:"180"}),m(n,{prop:"typeName",label:"物料种类",width:"180"}),m(n,{prop:"isInvolveItem",label:"是否涉及",width:"180"}),m(n,{prop:"sapItemNum",label:"物料编号",width:"180"}),m(n,{prop:"sapItemName",label:"材料名称",width:"180"}),m(n,{prop:"assemblyQuantity",label:"装配数量",width:"180"}),m(n,{prop:"encapsulationSize",label:"封装（需要体现PAD的数量）"})])),_:1},8,["data"]),p("div",S,[m(l,{type:"primary",onClick:B},{default:b((()=>[j])),_:1})]),m(h,{modelValue:g.setVisible,"onUpdate:modelValue":a[3]||(a[3]=e=>g.setVisible=e)},{footer:b((()=>[p("span",k,[m(l,{onClick:a[2]||(a[2]=e=>g.setVisible=!1)},{default:b((()=>[U])),_:1}),m(l,{type:"primary",onClick:I},{default:b((()=>[C])),_:1})])])),default:b((()=>[m(i,{model:g.downloadSetForm},{default:b((()=>[m(d,{label:"板部件数量"},{default:b((()=>[m(f,{modelValue:g.downloadSetForm.number,"onUpdate:modelValue":a[1]||(a[1]=e=>g.downloadSetForm.number=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-4fa595ae"]]);export{B as default};
